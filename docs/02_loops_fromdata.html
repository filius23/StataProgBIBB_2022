<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Programmieren mit Stata - 2&nbsp; Schleifen aus Macros</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_reg.html" rel="next">
<link href="./01_macros.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Schleifen aus Macros</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Programmieren mit Stata</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Herzlich Willkommen</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_macros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Macros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_loops_fromdata.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Schleifen aus Macros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_reg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regressionsergebnisse weiterverarbeiten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_labels_variab.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Label- und Variablenfunktionen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Daten.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dateien- und DoFile-Verwaltung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_weiteres.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Weitere <code>macro</code> &amp; <code>matrix</code> Funktionen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_lit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literatur &amp; Links</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#local-erstellen-und-für-schleifen-verwenden" id="toc-local-erstellen-und-für-schleifen-verwenden" class="nav-link active" data-scroll-target="#local-erstellen-und-für-schleifen-verwenden"> <span class="header-section-number">2.1</span> local erstellen und für Schleifen verwenden</a></li>
  <li><a href="#schleifen-über-strings" id="toc-schleifen-über-strings" class="nav-link" data-scroll-target="#schleifen-über-strings"> <span class="header-section-number">2.2</span> Schleifen über strings</a>
  <ul class="collapse">
  <li><a href="#wörter-indizieren" id="toc-wörter-indizieren" class="nav-link" data-scroll-target="#wörter-indizieren"> <span class="header-section-number">2.2.1</span> Wörter indizieren</a></li>
  <li><a href="#wörter-zählen" id="toc-wörter-zählen" class="nav-link" data-scroll-target="#wörter-zählen"> <span class="header-section-number">2.2.2</span> Wörter zählen</a></li>
  <li><a href="#wörter-in-schleife" id="toc-wörter-in-schleife" class="nav-link" data-scroll-target="#wörter-in-schleife"> <span class="header-section-number">2.2.3</span> Wörter in Schleife</a></li>
  </ul></li>
  <li><a href="#informationen-aus-schleifen-behalten" id="toc-informationen-aus-schleifen-behalten" class="nav-link" data-scroll-target="#informationen-aus-schleifen-behalten"> <span class="header-section-number">2.3</span> Informationen aus Schleifen behalten</a>
  <ul class="collapse">
  <li><a href="#gespeicherte-ergebnisse" id="toc-gespeicherte-ergebnisse" class="nav-link" data-scroll-target="#gespeicherte-ergebnisse"> <span class="header-section-number">2.3.1</span> Gespeicherte Ergebnisse</a></li>
  <li><a href="#e-und-r-sind-getrennte-welten" id="toc-e-und-r-sind-getrennte-welten" class="nav-link" data-scroll-target="#e-und-r-sind-getrennte-welten"> <span class="header-section-number">2.3.2</span> <code>e()</code> und <code>r()</code> sind getrennte Welten</a></li>
  </ul></li>
  <li><a href="#ergebnisse-weiter-verwenden" id="toc-ergebnisse-weiter-verwenden" class="nav-link" data-scroll-target="#ergebnisse-weiter-verwenden"> <span class="header-section-number">2.4</span> Ergebnisse weiter verwenden</a>
  <ul class="collapse">
  <li><a href="#recur" id="toc-recur" class="nav-link" data-scroll-target="#recur"> <span class="header-section-number">2.4.1</span> Rekursivität</a></li>
  </ul></li>
  <li><a href="#mat1" id="toc-mat1" class="nav-link" data-scroll-target="#mat1"> <span class="header-section-number">2.5</span> Kennzahlen in einer <code>matrix</code> ablegen</a>
  <ul class="collapse">
  <li><a href="#namen-für-spalten-und-zeilen-einer-matrix" id="toc-namen-für-spalten-und-zeilen-einer-matrix" class="nav-link" data-scroll-target="#namen-für-spalten-und-zeilen-einer-matrix"> <span class="header-section-number">2.5.1</span> Namen für Spalten und Zeilen einer <code>matrix</code></a></li>
  <li><a href="#mcollect" id="toc-mcollect" class="nav-link" data-scroll-target="#mcollect"> <span class="header-section-number">2.5.2</span> <code>matrix</code> erstellen</a></li>
  </ul></li>
  <li><a href="#labels-behalten" id="toc-labels-behalten" class="nav-link" data-scroll-target="#labels-behalten"> <span class="header-section-number">2.6</span> Labels behalten</a>
  <ul class="collapse">
  <li><a href="#labfun" id="toc-labfun" class="nav-link" data-scroll-target="#labfun"> <span class="header-section-number">2.6.1</span> <code>extended macro function</code> für Labels</a></li>
  <li><a href="#mrown" id="toc-mrown" class="nav-link" data-scroll-target="#mrown"> <span class="header-section-number">2.6.2</span> Labels als <code>rowname</code></a></li>
  </ul></li>
  <li><a href="#von-der-matrix-zum-datensatz" id="toc-von-der-matrix-zum-datensatz" class="nav-link" data-scroll-target="#von-der-matrix-zum-datensatz"> <span class="header-section-number">2.7</span> Von der <code>matrix</code> zum Datensatz</a></li>
  <li><a href="#frame" id="toc-frame" class="nav-link" data-scroll-target="#frame"> <span class="header-section-number">2.8</span> <code>frame</code>: mehrere Datensätze in Stata</a></li>
  <li><a href="#übungen" id="toc-übungen" class="nav-link" data-scroll-target="#übungen"> <span class="header-section-number">2.9</span> Übungen</a>
  <ul class="collapse">
  <li><a href="#loop1" id="toc-loop1" class="nav-link" data-scroll-target="#loop1"> <span class="header-section-number">2.9.1</span> Übung</a></li>
  <li><a href="#retue1" id="toc-retue1" class="nav-link" data-scroll-target="#retue1"> <span class="header-section-number">2.9.2</span> Übung</a></li>
  <li><a href="#retue2" id="toc-retue2" class="nav-link" data-scroll-target="#retue2"> <span class="header-section-number">2.9.3</span> Übung</a></li>
  <li><a href="#retue3" id="toc-retue3" class="nav-link" data-scroll-target="#retue3"> <span class="header-section-number">2.9.4</span> Übung</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="loopmacro" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Schleifen aus Macros</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="local-erstellen-und-für-schleifen-verwenden" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="local-erstellen-und-für-schleifen-verwenden"><span class="header-section-number">2.1</span> local erstellen und für Schleifen verwenden</h2>
<p>Schleifen aus globals / locals mit Hilfe von <code>levelsof</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> m1202</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">levelsof</span> m1202</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">levelsof</span> m1202, loc(ausb)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">local</span> ausb {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"m1202: "</span> <span class="ot">`lvl'</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">levelsof</span> m1202, loc(ausb)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>glo ausb <span class="ot">`ausb'</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">l</span> ausb</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">global</span> ausb {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"m1202: "</span> <span class="ot">`lvl'</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">global</span> ausb {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"m1202: "</span> <span class="ot">`lvl'</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="schleifen-über-strings" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="schleifen-über-strings"><span class="header-section-number">2.2</span> Schleifen über strings</h2>
<section id="wörter-indizieren" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="wörter-indizieren"><span class="header-section-number">2.2.1</span> Wörter indizieren</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> phrase <span class="st">`"</span> <span class="st">"2 guys"</span> <span class="st">"1 girl"</span> <span class="st">"1 pizza place"</span> <span class="st">"'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="st">di "</span><span class="ot">`:word 2 of `phrase'</span> '<span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 girl</code></pre>
</div>
</div>
</section>
<section id="wörter-zählen" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="wörter-zählen"><span class="header-section-number">2.2.2</span> Wörter zählen</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> sentence <span class="st">"here is a sentence 7"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> len: <span class="fu">word</span> <span class="fu">count</span> <span class="ot">`sentence'</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _len</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_len:           5</code></pre>
</div>
</div>
</section>
<section id="wörter-in-schleife" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="wörter-in-schleife"><span class="header-section-number">2.2.3</span> Wörter in Schleife</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> phrase1 <span class="st">"here is a sentence of 7 words"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> len1: <span class="fu">word</span> <span class="fu">count</span> <span class="ot">`phrase1'</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> i = 1(1)<span class="ot">`len1'</span> {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    loc <span class="fu">word</span>: <span class="fu">word</span> <span class="ot">`i'</span> <span class="kw">of</span> <span class="ot">`phrase1'</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"this is word number "</span> <span class="ot">`i'</span> <span class="st">": `word'"</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>this is word number 1: here
this is word number 2: is
this is word number 3: a
this is word number 4: sentence
this is word number 5: of
this is word number 6: 7
this is word number 7: words</code></pre>
</div>
</div>
<p>… dabei macht es einen Unterschied, wo die <code>""</code> stehen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> phrase2 <span class="st">`"</span> <span class="st">"here is"</span> <span class="st">"a sentence"</span> <span class="st">"of 7 words"</span> <span class="st">"'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">local len2: word count `phrase2'</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">forvalues i = 1(1)`len2' {</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">    loc word: word `i' of `phrase2'</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">    dis "</span>this is <span class="fu">word</span> number <span class="st">" `i' "</span>: <span class="ot">`word'</span><span class="st">"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>this is word number 1: here is
this is word number 2: a sentence
this is word number 3: of 7 words</code></pre>
</div>
</div>
<hr>
<p><strong><a href="#loop">Übung</a></strong></p>
<hr>
</section>
</section>
<section id="informationen-aus-schleifen-behalten" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="informationen-aus-schleifen-behalten"><span class="header-section-number">2.3</span> Informationen aus Schleifen behalten</h2>
<section id="gespeicherte-ergebnisse" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="gespeicherte-ergebnisse"><span class="header-section-number">2.3.1</span> Gespeicherte Ergebnisse</h3>
<p>Um auf Ergebnisse zuzugreifen, können wir etwas hinter die Kulissen der Stata-Befehle sehen:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-condensed" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;color: white !important;"> Befehl </th>
   <th style="text-align:left;color: white !important;"> zeigt alle </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-family: monospace;"> c-class </td>
   <td style="text-align:left;"> system parameters &amp; settings finden wir als `c()` </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> r-class </td>
   <td style="text-align:left;"> die meisten deskriptiven Befehle speichern die Ergebnisse in in `r()` </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> e-class </td>
   <td style="text-align:left;"> ...außer estimation commands, wie bspw. `reg` - hier wird in `e()` gespeichert (Postestimates) </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> s-class </td>
   <td style="text-align:left;"> parsing commands store results in `s()` used by programmers </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> n-class </td>
   <td style="text-align:left;"> commands that do not store in `r()`, `e()`, oder `s()` </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Jeweils alle Werte anzeigen mit:</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-condensed" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Befehl </th>
   <th style="text-align:left;"> zeigt alle </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-family: monospace;"> return list </td>
   <td style="text-align:left;font-family: monospace;"> r() </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> ereturn list </td>
   <td style="text-align:left;font-family: monospace;"> e() </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> sreturn list </td>
   <td style="text-align:left;font-family: monospace;"> s() </td>
  </tr>
  <tr>
   <td style="text-align:left;font-family: monospace;"> creturn list </td>
   <td style="text-align:left;font-family: monospace;"> c() </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Es gibt dabei vier Typen an Ergebnissen:</p>
<ul>
<li><code>macro</code>: strings mit mehreren Wörtern (Text)</li>
<li><code>matrix</code>: bspw. <code>e(b)</code> sind die Koeffizienten nach einem <code>reg</code>-Befehl oder <code>e(V)</code> ist die Varianz–Kovarianz Matrix der estimates (VCE)</li>
<li><code>scalar</code>: einzelne Zahlen/Strings (1x1 Matrizen)</li>
<li><code>functions</code>: bspw. <code>e(sample)</code> <span class="math inline">\(\Rightarrow\)</span> 1 (true) wenn die Beobachtung im vorheringen “estimation command” verwendet wurde und 0 (false) wenn nicht</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> <span class="ot">list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |     10,074       50.34       50.34
   weiblich |      9,938       49.66      100.00
------------+-----------------------------------
      Total |     20,012      100.00


scalars:
                  r(N) =  20012
                  r(r) =  2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>su S1</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> <span class="ot">list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          S1 |     20,012    1.496602    .5000009          1          2


scalars:
                  r(N) =  20012
              r(sum_w) =  20012
               r(mean) =  1.496602038776734
                r(Var) =  .2500009464113147
                 r(sd) =  .500000946410419
                r(min) =  1
                r(max) =  2
                r(sum) =  29950</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> F518_SUF zpalter </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ereturn</span> <span class="ot">list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      Source |       SS           df       MS      Number of obs   =    16,543
-------------+----------------------------------   F(1, 16541)     =    105.36
       Model |  1.3092e+09         1  1.3092e+09   Prob &gt; F        =    0.0000
    Residual |  2.0555e+11    16,541    12426773   R-squared       =    0.0063
-------------+----------------------------------   Adj R-squared   =    0.0063
       Total |  2.0686e+11    16,542    12505168   Root MSE        =    3525.2

------------------------------------------------------------------------------
    F518_SUF |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     zpalter |   24.62253   2.398848    10.26   0.000     19.92053    29.32453
       _cons |    2381.28    115.577    20.60   0.000     2154.736    2607.823
------------------------------------------------------------------------------


scalars:
                  e(N) =  16543
               e(df_m) =  1
               e(df_r) =  16541
                  e(F) =  105.3561454498825
                 e(r2) =  .0063290815436915
               e(rmse) =  3525.162828161657
                e(mss) =  1309236899.97876
                e(rss) =  205551251614.9366
               e(r2_a) =  .0062690083366028
                 e(ll) =  -158590.4618746699
               e(ll_0) =  -158642.9792418738
               e(rank) =  2

macros:
            e(cmdline) : "regress F518_SUF zpalter"
              e(title) : "Linear regression"
          e(marginsok) : "XB default"
                e(vce) : "ols"
             e(depvar) : "F518_SUF"
                e(cmd) : "regress"
         e(properties) : "b V"
            e(predict) : "regres_p"
              e(model) : "ols"
          e(estat_cmd) : "regress_estat"

matrices:
                  e(b) :  1 x 2
                  e(V) :  2 x 2

functions:
             e(sample)   </code></pre>
</div>
</div>
<p>Anstatt zu versuchen, den Überblick darüber zu behalten, was wo gespeichert wird, finden wir ganz unten in jeder Hilfedatei einen Hinweis wie “<code>summarize</code> stores the following in <code>r()</code>:” or “<code>mean</code> stores the following in <code>e()</code>” - entsprechend sehen wir die Ergebnisse in <code>return</code> bzw. <code>ereturn</code>.</p>
</section>
<section id="e-und-r-sind-getrennte-welten" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="e-und-r-sind-getrennte-welten"><span class="header-section-number">2.3.2</span> <code>e()</code> und <code>r()</code> sind getrennte Welten</h3>
<p>Neben dem Prinzip “One Data” folgt Stata auch dem Prinzip “One _-class”. Das bedeutet, dass wir nur den return oder ereturn für den letzten Befehl <em>dieser</em> Klasse sehen können. Wenn wir also <code>reg</code> ausführen und dann eine Reihe von r-Klassen-Aufrufen machen (z.B. <code>su</code>), wird uns der Aufruf von <code>ereturn</code> immer noch die Werte für <code>reg</code> anzeigen. Sobald wir jedoch einen weiteren r-class-Befehl ausführen, verlieren wir den Zugriff auf die Ergebnisse des ersten Befehls.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> az F200</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>su az</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ereturn</span> <span class="ot">list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      Source |       SS           df       MS      Number of obs   =    17,376
-------------+----------------------------------   F(1, 17374)     =  33637.44
       Model |  1269310.92         1  1269310.92   Prob &gt; F        =    0.0000
    Residual |  655608.985    17,374   37.735063   R-squared       =    0.6594
-------------+----------------------------------   Adj R-squared   =    0.6594
       Total |   1924919.9    17,375  110.786757   Root MSE        =    6.1429

------------------------------------------------------------------------------
          az |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        F200 |   .9897533   .0053965   183.41   0.000     .9791755    1.000331
       _cons |   3.937849   .1903973    20.68   0.000     3.564651    4.311047
------------------------------------------------------------------------------

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          az |     20,012    38.30557    11.75297         10        120


scalars:
                  e(N) =  17376
               e(df_m) =  1
               e(df_r) =  17374
                  e(F) =  33637.43995203968
                 e(r2) =  .6594097320849045
               e(rmse) =  6.142887188019294
                e(mss) =  1269310.915908093
                e(rss) =  655608.9846442067
               e(r2_a) =  .6593901286390708
                 e(ll) =  -56197.03934279057
               e(ll_0) =  -65554.6676770772
               e(rank) =  2

macros:
            e(cmdline) : "regress az F200"
              e(title) : "Linear regression"
          e(marginsok) : "XB default"
                e(vce) : "ols"
             e(depvar) : "az"
                e(cmd) : "regress"
         e(properties) : "b V"
            e(predict) : "regres_p"
              e(model) : "ols"
          e(estat_cmd) : "regress_estat"

matrices:
                  e(b) :  1 x 2
                  e(V) :  2 x 2

functions:
             e(sample)   </code></pre>
</div>
</div>
<!-- https://cscar.github.io/workshop-stata-intro/programming-advanced-features.html -->
</section>
</section>
<section id="ergebnisse-weiter-verwenden" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="ergebnisse-weiter-verwenden"><span class="header-section-number">2.4</span> Ergebnisse weiter verwenden</h2>
<p>Alle diese Informationen können wir mit einem Makro speichern bzw. weiter verarbeiten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>su S1</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"Der Mittelwert beträgt: "</span> <span class="fu">r</span>(<span class="kw">mean</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Der Mittelwert beträgt: 1.496602</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>su S1</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"Der Mittelwert beträgt: "</span> <span class="fu">round</span>(<span class="fu">r</span>(<span class="kw">mean</span>),.01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Der Mittelwert beträgt: 1.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">global</span> ausb {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"m1202: "</span> <span class="ot">`lvl'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    su S01 <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    dis <span class="fu">r</span>(<span class="kw">mean</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">global</span> ausb {</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> su S01 <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"Der Frauenanteil in m1202="</span> <span class="ot">`lvl'</span> <span class="st">" beträgt: "</span> <span class="fu">round</span>(<span class="fu">r</span>(<span class="kw">mean</span>)*100,.1) <span class="st">"%"</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">global</span> ausb {</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> su S01 <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    glo gend<span class="ot">`lvl'</span>: <span class="kw">display</span> <span class="st">"Der Frauenanteil in m1202="</span> <span class="ot">`lvl'</span> <span class="st">" beträgt: "</span> <span class="fu">round</span>(<span class="fu">r</span>(<span class="kw">mean</span>)*100,.1) <span class="st">"%"</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="recur" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="recur"><span class="header-section-number">2.4.1</span> Rekursivität</h3>
<p>Macros können auch “recursively” erstellt werden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> x <span class="st">""</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> i = 1/20 {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> x <span class="ot">$x</span> <span class="ot">`i'</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x:              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20</code></pre>
</div>
</div>
<p>…somit können wir einen <code>global</code> auch zusammenbauen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>glo gend <span class="st">""</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">global</span> ausb {</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> su S01 <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    glo gend: <span class="kw">display</span> <span class="st">"${gend}m1202="</span> <span class="ot">`lvl'</span> <span class="st">" "</span> <span class="fu">round</span>(<span class="fu">r</span>(<span class="kw">mean</span>)*100,.1) <span class="st">"% "</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">l</span> gend</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  4. }

gend:           m1202=1 45.6% m1202=2 53% m1202=3 37.8% m1202=4 48.9%</code></pre>
</div>
</div>
<hr>
<p><strong><a href="#retue1">Übung</a></strong></p>
<hr>
</section>
</section>
<section id="mat1" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="mat1"><span class="header-section-number">2.5</span> Kennzahlen in einer <code>matrix</code> ablegen</h2>
<p>Matrizen helfen uns, die ergebnisse in handhabarer Form zu speichern (<code>help matrix</code>). Um eine Tabelle zu bauen benötigen wir einige Matrix-Befehle, weiteres unter <code>help matrix operators</code></p>
<ul>
<li><p>eine <code>matrix</code> ausgeben: <code>matrix list matname</code></p></li>
<li><p>eine <code>matrix</code> umbenennen: <code>matrix umbenennen altername neuername</code></p></li>
<li><p>eine <code>matrix</code> oder alle löschen: <code>matrix drop [matlist]</code></p></li>
</ul>
<div class="cell">
<div class="cell-output-display">

<table class="table table-condensed" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Operator </th>
   <th style="text-align:left;"> Symbol </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> column join </td>
   <td style="text-align:left;font-family: monospace;"> , </td>
  </tr>
  <tr>
   <td style="text-align:left;"> row join </td>
   <td style="text-align:left;font-family: monospace;"> \\ </td>
  </tr>
  <tr>
   <td style="text-align:left;"> transpose </td>
   <td style="text-align:left;font-family: monospace;"> ' </td>
  </tr>
  <tr>
   <td style="text-align:left;"> negation </td>
   <td style="text-align:left;font-family: monospace;"> - </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span> Y1 = 1, 3 </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> Y1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Y1[1,2]
    c1  c2
r1   1   3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span> Y2 = 4\ 0</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> Y2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Y2[2,1]
    c1
r1   4
r2   0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span> Y = (2, 1.5 \ 2.5, 3)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Y[2,2]
     c1   c2
r1    2  1.5
r2  2.5    3</code></pre>
</div>
</div>
<p>Transponieren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span> X2 = (1, 2, 3 \ 5 , 8 , 9)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> X2 </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>mat X3 = X2'</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> X3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X2[2,3]
    c1  c2  c3
r1   1   2   3
r2   5   8   9



X3[3,2]
    r1  r2
c1   1   5
c2   2   8
c3   3   9</code></pre>
</div>
</div>
<p>Mit <code>J(Zeilen,Spalten,Inhalt)</code> können wir eine Matrix mit gleichen Werten besetzen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mat G0 = <span class="fu">J</span>(4,2,0)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> G0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>G0[4,2]
    c1  c2
r1   0   0
r2   0   0
r3   0   0
r4   0   0</code></pre>
</div>
</div>
<!-- Mit `mat name[Spalte,Zeile]` können wir auf einen Teilbereich zugreifen: -->
<!-- ```{stata matrix04c} -->
<!-- mat G0 = J(4,2,0) -->
<!-- mat G0[3,2] = 2 -->
<!-- mat list G0 -->
<!-- ``` -->
<section id="namen-für-spalten-und-zeilen-einer-matrix" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="namen-für-spalten-und-zeilen-einer-matrix"><span class="header-section-number">2.5.1</span> Namen für Spalten und Zeilen einer <code>matrix</code></h3>
<p>Aber wir können die Zeilennamen einer <code>matrix</code> verändern:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mat colname G0 = var1 var2</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">list</span> G0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>G0[4,2]
    var1  var2
r1     0     0
r2     0     0
r3     0     2
r4     0     0</code></pre>
</div>
</div>
<p>Wenn zu wenige Namen angegeben werden, wird der letzte Wert einfach wiederholt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mat rowname G0 = <span class="fu">year</span> result</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">list</span> X1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>G0[4,2]
        c1  c2
  year   0   0
result   0   0
result   0   2
result   0   0</code></pre>
</div>
</div>
<!-- ### Zeile einfügen -->
<!-- ```{stata tm08, eval = F} -->
<!-- matrix A = J(3,4,.)  -->
<!-- mat A1 = (1, 4, 2, 1)  -->
<!-- ``` -->
<!-- ```{stata tm10, eval = F} -->
<!-- mat A[1,1]  =A1 // !! überschreibt die ganze 1. Zeile -->
<!-- mat li A -->
<!-- ``` -->
<!-- ```{stata tm11, echo = F} -->
<!-- matrix A = J(3,4,.) // A besteht nur aus . -->
<!-- mat A1 = (1, 4, 2, 1) -->
<!-- mat A[1,1]  =A1 // !! überschreibt die ganze 1. Zeile -->
<!-- mat li A -->
<!-- ``` -->
</section>
<section id="mcollect" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="mcollect"><span class="header-section-number">2.5.2</span> <code>matrix</code> erstellen</h3>
<p>Das nutzen wir jetzt um unsere Ergebnisse zu speichern:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">levelsof</span> m1202, loc(ausb)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">local</span> ausb {</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> su S01 <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 1. Spalte level von m1202</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">//2.Spalte: Frauenanteil</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    mat G<span class="ot">`lvl'</span> = <span class="ot">`lvl'</span> ,<span class="fu">r</span>(<span class="kw">mean</span>)*100 </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>mat G = GX1\GX2\GX3\GX4</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>mat colname G = m1202 share_w</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Damit können wir auch zeilenweise eine <code>matrix</code> befüllen, indem wir mit <code>,</code> mehrere Werte verbinden (<a href="#mat1">row join</a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">levelsof</span> m1202, loc(ausb)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">local</span> ausb {</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> su zpalter <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span>, <span class="fu">det</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    mat A<span class="ot">`lvl'</span> = <span class="ot">`lvl'</span>, <span class="fu">r</span>(p25), <span class="fu">r</span>(<span class="kw">mean</span>), <span class="fu">r</span>(p50), <span class="fu">r</span>(p75)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>mat A = A1\A2\A3\A4</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>mat colname A = m1202 p25 <span class="kw">mean</span> <span class="kw">median</span> p75</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>A[4,5]
        m1202        p25       mean     median        p75
r1          1         29  42.627213         46         55
r1          2         39  47.076531         49         56
r1          3         41  48.092344         50         56
r1          4         39  47.760744         49         57</code></pre>
</div>
</div>
<hr>
<p><strong><a href="#retue2">Übung</a></strong></p>
<hr>
</section>
</section>
<section id="labels-behalten" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="labels-behalten"><span class="header-section-number">2.6</span> Labels behalten</h2>
<section id="labfun" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="labfun"><span class="header-section-number">2.6.1</span> <code>extended macro function</code> für Labels</h3>
<p>Idealerweise würden wir aber gerne nicht nur 1-4 in <code>m1202</code> behalten, sondern die Labels (<code>Ohne Berufsabschluss</code>) usw. Um Informationen zu Variablen &amp; Labels abzurufen, lernen wir <a href="04_labels_variab.html#labfuns">später</a> eine ganze Reihe an extended macro functions kennen, für den Moment reicht uns <code>label (varname) varvalue</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>loc v m1202</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> vallab1 :    <span class="kw">label</span> (<span class="ot">`v'</span>) 1            <span class="co">// Value label für Wert = 1</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"`vallab1'"</span>     <span class="co">// display local "valuelab1"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Ohne Berufsabschluss</code></pre>
</div>
</div>
<p>In der Schleife können wir dann <code>lvl</code> entsprechen für <code>label (var) lvl</code> nutzen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>loc lvl = 1</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> su zpalter <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span>, <span class="fu">det</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>mat GX = <span class="ot">`lvl'</span>, <span class="fu">r</span>(p25), <span class="fu">r</span>(<span class="kw">mean</span>), <span class="fu">r</span>(p50), <span class="fu">r</span>(p75) </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> vallab1 :    <span class="kw">label</span> (m1202) <span class="ot">`lvl'</span> <span class="co">// label aufrufen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mrown" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="mrown"><span class="header-section-number">2.6.2</span> Labels als <code>rowname</code></h3>
<p>Leider können wir nicht einfach die Labels der Variable in die <code>matrix</code> schreiben. In einer Matrix sind nur Zahlenwerte erlaubt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mat M = c(2\<span class="st">"label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>r(133);

end of do-file
r(133);</code></pre>
</div>
</div>
<p>Aber wir können das Label als rowname ablegen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>loc lvl = 1</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> su zpalter <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span>, <span class="fu">det</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>mat GX = <span class="ot">`lvl'</span>, <span class="fu">r</span>(p25), <span class="fu">r</span>(<span class="kw">mean</span>), <span class="fu">r</span>(p50), <span class="fu">r</span>(p75) </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> vallab1 :    <span class="kw">label</span> (m1202) <span class="ot">`lvl'</span> <span class="co">// label aufrufen</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>mat rowname GX =  <span class="st">"`vallab1'"</span> <span class="co">// in Zeilenname ablegen</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> GX</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>…damit erweitern wir die Schleife von oben:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">levelsof</span> m1202, loc(ausb)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> lvl  <span class="kw">of</span> <span class="kw">local</span> ausb {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> su zpalter <span class="kw">if</span> m1202 == <span class="ot">`lvl'</span>, <span class="fu">det</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    mat GX<span class="ot">`lvl'</span> = <span class="ot">`lvl'</span>, <span class="fu">r</span>(p25), <span class="fu">r</span>(<span class="kw">mean</span>), <span class="fu">r</span>(p50), <span class="fu">r</span>(p75)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> vallab1 :    <span class="kw">label</span> (m1202) <span class="ot">`lvl'</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    mat rowname GX<span class="ot">`lvl'</span> =  <span class="st">"`vallab1'"</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>mat G = GX1\GX2\GX3\GX4</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>mat colname G = m1202 p25 <span class="kw">mean</span> <span class="kw">median</span> p75</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">l</span> G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4





G[4,5]
                  m1202        p25       mean     median        p75
Ohne Beruf~s          1         29  42.627213         46         55
duale o. s~l          2         39  47.076531         49         56
Aufstiegsf~T          3         41  48.092344         50         56
Fachhochsc~h          4         39  47.760744         49         57</code></pre>
</div>
</div>
<div class="cell">

</div>
</section>
</section>
<section id="von-der-matrix-zum-datensatz" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="von-der-matrix-zum-datensatz"><span class="header-section-number">2.7</span> Von der <code>matrix</code> zum Datensatz</h2>
<p>Mit <code>xsvmat</code> bzw. dem ado <code>xsvmat</code> können wir eine <code>matrix</code> in einen Datensatz umwandeln. Mit <code>rownames(lab)</code> können wir Zeilennamen in die Variable <code>lab</code> ablegen. Außerdem nutzt <code>xsvmat</code> die neue <a href="#frame"><code>frame</code></a>- Funktion, um einen neuen Datensatz zu erstellen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ssc</span> install  xsvmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>xsvmat G, names(col) frame(res1) <span class="ot">rownames</span>(lab)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>frame change res1</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="ot">list</span>, <span class="kw">noobs</span> <span class="kw">clean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>                                                         lab   m1202   p25       <span class="kw">mean</span>   <span class="kw">median</span>   p75  </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                                        Ohne Berufsabschluss       1    29   42.62721       46    55  </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    duale o. schulische Berufsausbildung/einf.,mittl. Beamte       2    39   47.07653       49    56  </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    Aufstiegsfortbildung (Meister, Techniker, kfm. AFB u.ä.)       3    41   48.09234       50    56  </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>            Fachhochschule, Universität/ geh., höhere Beamte       4    39   47.76074       49    57  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="frame" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="frame"><span class="header-section-number">2.8</span> <code>frame</code>: mehrere Datensätze in Stata</h2>
<p>Die <code>frame</code>-Option basiert auf einer relativ neuen Funktion in Stata. Seit Version 16 bietet Stata mit den <a href="https://www.stata.com/features/overview/multiple-datasets-in-memory/"><code>frame</code></a>-Befehlen auch die Möglichkeit, mehrere Datensätze parallel zu bearbeiten.</p>
<ul>
<li>mit <code>frame create nameX</code> können wir einen neuen Datensatz mit dem Namen <code>nameX</code> erstellen (der bisherige wird als <code>default</code> bezeichnet)</li>
<li>mit <code>frame dir</code> bekommen wir eine Übersicht zu den verschiedenen <code>frame</code>s der aktuellen Stata-Session</li>
<li>mit <code>frame change</code> <em>name</em> können wir zwischen den verschiedenen <code>frame</code>s hin- und herspringen</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>frame change res1</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>frame change <span class="kw">default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>mit <code>frame drop</code> <em>name</em> können wir einen <code>frame</code> wieder löschen:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>frame <span class="kw">drop</span> res1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<hr>
<p><strong><a href="#retue3">Übung</a></strong></p>
<hr>
</section>
<section id="übungen" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="übungen"><span class="header-section-number">2.9</span> Übungen</h2>
<section id="loop1" class="level3" data-number="2.9.1">
<h3 data-number="2.9.1" class="anchored" data-anchor-id="loop1"><span class="header-section-number">2.9.1</span> Übung</h3>
<ul>
<li>Zählen Sie die Wörter in den folgenden beiden String-locals</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>loc x1 <span class="st">"ein sehr langer satz mit vielen wörtern"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ds</span> *wib*</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>loc <span class="kw">x2</span> =  <span class="fu">r</span>(<span class="kw">varlist</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Wie würde eine Schleife aussehen, die jeweils ein Wort aus den locals nacheinander mit <code>display</code> ausgibt?</li>
</ul>
</section>
<section id="retue1" class="level3" data-number="2.9.2">
<h3 data-number="2.9.2" class="anchored" data-anchor-id="retue1"><span class="header-section-number">2.9.2</span> Übung</h3>
<ul>
<li>Laden Sie die Erwerbstätigenbefragung - am besten in der Version ohne Missings in den relevanten Variablen ( <code>"${data}/BIBBBAuA_2018_suf1.0_clean.dta"</code>, siehe <code>01_init.do</code>)</li>
<li>Erstellen Sie eine Schleife, welche jeweils das Maximaleinkommen (basierend auf <code>F518_SUF</code>) für die Gemeindegrößenklassen (<code>gkpol</code>) anzeigt.
<ul>
<li>Wie kommen Sie an den Maximalwert für <code>F518_SUF</code>? Verwenden Sie bspw. <code>su</code> oder <code>tabstat</code> zusammen mit <code>return list</code>.</li>
<li>Erstellen Sie mit <code>display</code> eine aussagekräftige Ausgabe</li>
<li>Testen Sie Ihre Schleifenlogik mit einem <code>local</code>, um anschließend die Schleife “außen herumzubauen”</li>
<li>Welche Ausprägungen hat <code>gkpol</code> - wie können Sie diese automatisch in eine Schleife überführen?</li>
</ul></li>
<li><em>Optional</em> Passen Sie Ihre Schleife an, sodass für jeden Durchlauf ein <code>global gkX</code> erstellt wird, wobei <code>X</code> für die Ausprägung von <code>gkpol</code> steht und den entsprechenden Maximalwert von <code>F518_SUF</code> für die entsprechende Größenklasse enthält.</li>
</ul>
</section>
<section id="retue2" class="level3" data-number="2.9.3">
<h3 data-number="2.9.3" class="anchored" data-anchor-id="retue2"><span class="header-section-number">2.9.3</span> Übung</h3>
<ul>
<li>Kopieren Sie die in Übung 2 erstellte Schleife und passen Sie diese <a href="#mcollect">so</a> an, dass jeweils die Werte für Min, Mean, Median, Max und N in <code>matrix</code> gesammelt werden.
<ul>
<li>Verwenden Sie den <code>row join</code> für <code>matrix</code> mit <code>,</code> um jeweils eine Ergebniszeile zu erstellen</li>
</ul></li>
</ul>
</section>
<section id="retue3" class="level3" data-number="2.9.4">
<h3 data-number="2.9.4" class="anchored" data-anchor-id="retue3"><span class="header-section-number">2.9.4</span> Übung</h3>
<ul>
<li>Passen Ihre Schleife von eben mit <code>gkpol</code> so mit Hilfe der Schleife von <a href="#mrown">oben</a> so an, dass die Labels für <code>gkpol</code> als <code>rownames</code> werden legen Sie die Ergebnismatrix in einen <code>frame</code> ab.
<ul>
<li>Nutzen Sie die <a href="#labfun"><code>label (v') 1</code></a> extended macro function um das jeweilige Label anzuzeigen</li>
<li>Setzen Sie das entsprechende Label als <code>rowname</code></li>
<li>Fügen Sie die einzelnen Ergebnis in eine <code>matrix</code> zusammen</li>
<li>Nutzen Sie <code>xsvmat</code>, um einen <code>frame</code> zu erstellen</li>
<li>Nutzen Sie <code>frame change</code>, um in die Ergebnis-<code>frame</code> zu wechseln (und wieder zurück)</li>
</ul></li>
</ul>
<!-- *Für alle, die schon fertig sind:* -->
<!-- - Wie könnten Sie mit Hilfe einer Schleife den Schritt des Zusammenfügens mit weniger Tipparbeit erledigen?  -->
<!-- ```{stata, eval = F} -->
<!-- mat G = GX1\GX2\GX3\GX4\GX5\GX6\GX7 -->
<!-- ``` -->
<!--   + Tipp: Überführen Sie die erste Ergebnis-`matrix` in eine neue Ergebnismatrix, an die dann die weiteren `matrix` per `row join` angefügt werden - ggf. hilft hier `if`/`else` -->
<!--   + Ließe sich auch ein Befehl integrieren, der die `matrix` für Einzelergebnisse dann gleich wieder löscht? -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>

<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_macros.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Macros</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_reg.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regressionsergebnisse weiterverarbeiten</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Alle Kursinhalte <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> 2022 von <a href="https://afilser.netlify.app/">Andreas Filser</a><br> <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC Lizenz mit Namensnennung <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-by" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-nc" aria-hidden="true"></i></a><br> Erstellt mit <i class="fa-brands fa-r-project" aria-hidden="true"></i> &amp; <a href="https://www.ssc.wisc.edu/~hemken/Stataworkshops/Statamarkdown/stata-and-r-markdown.html">Statamarkdown</a>, Code <a href="https://github.com/filius23/StataBIBB_tables2022">hier einsehbar <i class="fa-brands fa-github" aria-hidden="true"></i></a></div>
  </div>
</footer>



</body></html>