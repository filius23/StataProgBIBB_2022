<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Programmieren mit Stata - 1&nbsp; Macros</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02_loops_fromdata.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Macros</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Programmieren mit Stata</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Herzlich Willkommen</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_macros.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Macros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_loops_fromdata.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Schleifen aus Macros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_reg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regressionsergebnisse weiterverarbeiten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_labels_variab.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Label- und Variablenfunktionen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Daten.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dateien- und DoFile-Verwaltung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_weiteres.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Weitere <code>macro</code> &amp; <code>matrix</code> Funktionen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_lit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literatur &amp; Links</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#macht-einen-unterschied" id="toc-macht-einen-unterschied" class="nav-link active" data-scroll-target="#macht-einen-unterschied"> <span class="header-section-number">1.1</span> <code>=</code> macht einen Unterschied</a></li>
  <li><a href="#local-und-global-sind-getrennte-welten" id="toc-local-und-global-sind-getrennte-welten" class="nav-link" data-scroll-target="#local-und-global-sind-getrennte-welten"> <span class="header-section-number">1.2</span> <code>local</code> und <code>global</code> sind getrennte Welten</a></li>
  <li><a href="#macros-mit-text" id="toc-macros-mit-text" class="nav-link" data-scroll-target="#macros-mit-text"> <span class="header-section-number">1.3</span> Macros mit Text</a></li>
  <li><a href="#dateipfade" id="toc-dateipfade" class="nav-link" data-scroll-target="#dateipfade"> <span class="header-section-number">1.4</span> Dateipfade</a></li>
  <li><a href="#cmac" id="toc-cmac" class="nav-link" data-scroll-target="#cmac"> <span class="header-section-number">1.5</span> Bereits definierte Macros</a>
  <ul class="collapse">
  <li><a href="#if1" id="toc-if1" class="nav-link" data-scroll-target="#if1"> <span class="header-section-number">1.5.1</span> <code>if</code></a></li>
  <li><a href="#macros-als-variablennamen-und-befehle" id="toc-macros-als-variablennamen-und-befehle" class="nav-link" data-scroll-target="#macros-als-variablennamen-und-befehle"> <span class="header-section-number">1.5.2</span> Macros als Variablennamen und Befehle</a></li>
  <li><a href="#allglo" id="toc-allglo" class="nav-link" data-scroll-target="#allglo"> <span class="header-section-number">1.5.3</span> <code>globals</code> durchsuchen</a></li>
  </ul></li>
  <li><a href="#wenn-nicht-if-dann-else" id="toc-wenn-nicht-if-dann-else" class="nav-link" data-scroll-target="#wenn-nicht-if-dann-else"> <span class="header-section-number">1.6</span> Wenn nicht <code>if</code>, dann <code>else</code></a></li>
  <li><a href="#unterbrechen-wenn-ein-fehler-vorliegt" id="toc-unterbrechen-wenn-ein-fehler-vorliegt" class="nav-link" data-scroll-target="#unterbrechen-wenn-ein-fehler-vorliegt"> <span class="header-section-number">1.7</span> Unterbrechen wenn ein Fehler vorliegt</a></li>
  <li><a href="#schleifen-foreach-forvalues" id="toc-schleifen-foreach-forvalues" class="nav-link" data-scroll-target="#schleifen-foreach-forvalues"> <span class="header-section-number">1.8</span> Schleifen: <code>foreach</code> &amp; <code>forvalues</code></a>
  <ul class="collapse">
  <li><a href="#ferest" id="toc-ferest" class="nav-link" data-scroll-target="#ferest"> <span class="header-section-number">1.8.1</span> <code>ferest()</code></a></li>
  <li><a href="#weitere-schleifentypen" id="toc-weitere-schleifentypen" class="nav-link" data-scroll-target="#weitere-schleifentypen"> <span class="header-section-number">1.8.2</span> Weitere Schleifentypen</a></li>
  <li><a href="#anwendung" id="toc-anwendung" class="nav-link" data-scroll-target="#anwendung"> <span class="header-section-number">1.8.3</span> Anwendung</a></li>
  <li><a href="#schleifen-aufbauen" id="toc-schleifen-aufbauen" class="nav-link" data-scroll-target="#schleifen-aufbauen"> <span class="header-section-number">1.8.4</span> Schleifen aufbauen</a></li>
  <li><a href="#nested-loop" id="toc-nested-loop" class="nav-link" data-scroll-target="#nested-loop"> <span class="header-section-number">1.8.5</span> nested loop</a></li>
  <li><a href="#display-vs.-macro-list" id="toc-display-vs.-macro-list" class="nav-link" data-scroll-target="#display-vs.-macro-list"> <span class="header-section-number">1.8.6</span> <code>display</code> vs.&nbsp;<code>macro list</code></a></li>
  </ul></li>
  <li><a href="#übungen" id="toc-übungen" class="nav-link" data-scroll-target="#übungen"> <span class="header-section-number">1.9</span> Übungen</a>
  <ul class="collapse">
  <li><a href="#ue0" id="toc-ue0" class="nav-link" data-scroll-target="#ue0"> <span class="header-section-number">1.9.1</span> Übung</a></li>
  <li><a href="#ue1" id="toc-ue1" class="nav-link" data-scroll-target="#ue1"> <span class="header-section-number">1.9.2</span> Übung</a></li>
  <li><a href="#ue2" id="toc-ue2" class="nav-link" data-scroll-target="#ue2"> <span class="header-section-number">1.9.3</span> FizzBuzz-Challenge</a></li>
  <li><a href="#ue3" id="toc-ue3" class="nav-link" data-scroll-target="#ue3"> <span class="header-section-number">1.9.4</span> Übung</a></li>
  </ul></li>
  <li><a href="#anhang" id="toc-anhang" class="nav-link" data-scroll-target="#anhang"> <span class="header-section-number">1.10</span> Anhang</a>
  <ul class="collapse">
  <li><a href="#dir" id="toc-dir" class="nav-link" data-scroll-target="#dir"> <span class="header-section-number">1.10.1</span> Windows Dateipfade mit macros</a></li>
  <li><a href="#debugging-wo-ist-der-wurm-drin" id="toc-debugging-wo-ist-der-wurm-drin" class="nav-link" data-scroll-target="#debugging-wo-ist-der-wurm-drin"> <span class="header-section-number">1.10.2</span> Debugging: Wo ist der Wurm drin?</a></li>
  <li><a href="#einstellung-für-ssc-install-an-bibb-arbeitsrechnern" id="toc-einstellung-für-ssc-install-an-bibb-arbeitsrechnern" class="nav-link" data-scroll-target="#einstellung-für-ssc-install-an-bibb-arbeitsrechnern"> <span class="header-section-number">1.10.3</span> Einstellung für <code>ssc install</code> an BIBB-Arbeitsrechnern</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="macro" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Macros</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

</div>
<p>Macros ist die Sammelbezeichung für <code>global</code>s und <code>local</code>s in Stata. Beide dienen zur (vorläufigen) Speicherung von Text- oder Zahleninformationen. Definiert werden sie durch <code>global</code><em>inhalt</em> oder <code>local</code><em>inhalt</em> - oft mit <code>glo</code> und <code>loc</code> als Abkürzungen. <code>global</code>s können dann mit <code>$globalname</code>/<code>${globalname}</code> aufgerufen werden, <code>local</code>s mit `<code>localname'</code> - ganz einfach bspw. mit <code>dis[play]</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>glo x = 1</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> = 2</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">${x}</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">`y'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1

2</code></pre>
</div>
</div>
<p>…oder mit <code>macro list</code>, hier sind die macros aber ohne “punctuation” (also <code>$</code> oder `<code>'</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>glo x = 1</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> = 2</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> x</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x:              1

_y:             2</code></pre>
</div>
</div>
<p>Der Unterschied besteht vor allem darin, dass <em>local</em> macros ‘lokal’ für ein spezifisches Programm verfügbar sind, <em>globale</em> macros hingegen für alle Programme (innerhalb einer Stata-Session) verfügbar sind. Letztlich können wir jede Instanz, in der wir mehrere Zeilen eines DoFiles ausführen als ‘Programm’ ansehen.</p>
<p><code>global</code>s können wir später nochmal aufrufen, <code>local</code>s nicht:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> xg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>xg:             1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _xl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>r(111);

end of do-file
r(111);</code></pre>
</div>
</div>
<section id="macht-einen-unterschied" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="macht-einen-unterschied"><span class="header-section-number">1.1</span> <code>=</code> macht einen Unterschied</h2>
<p>In der Regel können wir auch einfach <code>glo glname Wert</code> bzw. <code>loc locname Wert</code> statt <code>glo glname = Wert</code> bzw. <code>loc locname = Wert</code> angeben. Allerdings ist hier etwas Vorsicht geboten, denn das <code>=</code> ist entscheidend ob die Rechnung abgelegt wird oder das Ergebnis (<em>Stichwort evaluation</em>):</p>
<ul>
<li><p>Mit <code>=</code> : der Ausdruck wird “evaluated”</p></li>
<li><p>Ohne <code>=</code> : der Ausdruck wird “aliased”</p></li>
</ul>
<p>Im Ergebnis sehen wir hier beides Mal das gleiche:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m1 2+2</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m1'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m2 = 2+2</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m2'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
</div>
<p>Aber wenn wir uns mit <code>mac list</code> die abgelegten Infos ansehen, dann sehen wir den entscheidenden Unterschied:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _m1 _m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>_m1:            2+2
_m2:            4</code></pre>
</div>
</div>
<p>Wenn wir nämlich mit <code>m1</code> und <code>m2</code> weiterrechnen, da kann folgendes passieren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m1 2+2</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m1'</span>*4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m2 = 2+2</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m2'</span>*4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>16</code></pre>
</div>
</div>
<p>Denn <span class="math inline">\(2+2*4\neq4*4\)</span></p>
</section>
<section id="local-und-global-sind-getrennte-welten" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="local-und-global-sind-getrennte-welten"><span class="header-section-number">1.2</span> <code>local</code> und <code>global</code> sind getrennte Welten</h2>
<p>Geht, aber ist nicht zu empfehlen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">yx</span> = 1</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>loc <span class="kw">yx</span> = 2</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> <span class="kw">yx</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _yx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>yx:             1

_yx:            2</code></pre>
</div>
</div>
</section>
<section id="macros-mit-text" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="macros-mit-text"><span class="header-section-number">1.3</span> Macros mit Text</h2>
<p>Wir können macros zu Texten zusammenbauen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>glo t1 <span class="st">"Hallo"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>glo t2 <span class="st">" zusammen"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>glo t3 <span class="st">"! :-)"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>glo t4 = <span class="st">"${t1}${t2}${t3}"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"${t4}"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> t1 t2 t3 t4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hallo zusammen! :-)

t1:             Hallo
t2:              zusammen
t3:             ! :-)
t4:             Hallo zusammen! :-)</code></pre>
</div>
</div>
<hr>
<p><strong><a href="#ue0">Übung</a></strong></p>
<hr>
</section>
<section id="dateipfade" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="dateipfade"><span class="header-section-number">1.4</span> Dateipfade</h2>
<p>Ein macro kann auch Text enthalten und wir können diesen bspw. für Dateipfade macros verwenden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">"D:\Projekt\daten\BIBB_BAuA"</span> <span class="co">// wo liegt der Datensatz?</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"${pfad}/BIBBBAuA_2018_suf1.0.dta"</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir können das auch nutzen, um DoFiles in Kooperationsprojekten zu bauen, wenn verschiedenen Personen die DoFiles verwenden:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./pics/01_pfade.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">"C:\Projekte\Micha"</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">"D:\Arbeit\Alex"</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>glo prog <span class="st">"${pfad}/prog"</span>  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">data</span> <span class="st">"${pfad}/data"</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">log</span>  <span class="st">"${pfad}/log"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Micha würde dann immer den Pfad von Alex überspringen/auskommentieren und umgekehrt. Wir lernen <a href="#if1">gleich</a> noch eine Möglichkeit kennen, das auch direkt mit zu lösen mit dem Usernamen der verwendeten PCs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"${data}/BIBBBAuA_2018_suf1.0.dta"</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die <code>" "</code> sind nicht zwingend nötig in diesem Fall. Sollten aber Leerzeichen im Pfad vorkommen, brauchen wir auf jeden Fall <code>" "</code>. Außerdem ist <a href="#dir"><code>\</code> beim Zusammenbauen mit macros manchmal problematisch</a>) - auch hier helfen <code>" "</code>. Alternativ hilft hier <code>/</code> statt <code>\</code> zu verwenden.</p>
<p>Mit <code>mkdir</code> können wir auch Ordner erstellen. Wenn also noch kein log-Ordner existiert, können wir ihn so erstellen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mkdir</span> <span class="ot">${log}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mit <code>cap cd</code> können wir das vorher überprüfen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> cd  <span class="st">"${log}"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="dt">_rc</span>!=0  {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">mkdir</span> <span class="ot">${log}</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">"${log} erstellt"</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    } </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Siehe <code>01_init_beispiel.do</code> für ein Beispiel für einige Befehle beim Erstellen eines Projektverzeichnisses.</strong></p>
</section>
<section id="cmac" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="cmac"><span class="header-section-number">1.5</span> Bereits definierte Macros</h2>
<p>Mit <code>mac list</code> bekommen wir auch einige von Stata bereits vorgegebenen Macros angezeigt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zwei sehr nützliche sind dabei <code>$S_DATE</code> <code>$S_TIME</code> - das aktuelle Datum und die aktuelle Zeit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"$S_DATE"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"$S_TIME"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>2 May 2022</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>12:44:22</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Diese können wir beispielsweise am Anfang und Ende eines Abschnitts in einem LogFiles einblenden, um Start- und Endzeit zu dokumentieren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">using</span> <span class="st">"${log}/logfile.txt"</span>, t <span class="kw">replace</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> ....</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"Start: $S_DATE um $S_TIME"</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>Hier kommen aufwändige Modelle</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"Ende: $S_DATE um $S_TIME"</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>cap <span class="fu">log</span> <span class="kw">close</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So können wir beispielsweise automatisch log-Files mit einem Datum versehen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> <span class="fu">date</span> = <span class="fu">string</span>( <span class="kw">d</span>(<span class="ot">$S_DATE</span>), <span class="st">"%tdCY-N-D"</span> )</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>* <span class="kw">help</span> datetime_display_formats <span class="co">// für andere Datumsformate</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>cap <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">using</span> <span class="st">"${log}/01_macro_loops_${date}.log"</span>, <span class="kw">replace</span> <span class="bn">text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>. <span class="fu">log</span> <span class="kw">using</span> <span class="st">"${log}/01_macro_loops_${date}.log"</span>, <span class="kw">replace</span> <span class="bn">text</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">note</span>: file D:\Arbeit\Alex/<span class="fu">log</span>/01_macro_loops_2021-12-01.<span class="fu">log</span> <span class="kw">not</span> found)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>      <span class="bn">name</span>:  &lt;unnamed&gt;</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">log</span>:  D:\Arbeit\Alex/<span class="fu">log</span>/01_macro_loops_2021-12-01.<span class="fu">log</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span> <span class="dv">type</span>:  <span class="bn">text</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a> opened <span class="kw">on</span>:  01 Dec 2021, 10:45:04</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Außerdem gibt es einige <code>locals</code> mit nützlichen Infos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"`c(username)'"</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"`c(machine_type)'"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"`c(os)'"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Filser</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>PC (64-bit x86-64)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>Windows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Weitere “system parameters and settings” unter <code>help creturn</code> bspw.:</p>
<ul>
<li><code>c(changed)</code> returns a numeric scalar equal to 0 if the dataset in memory has not changed since it was last saved and 1 otherwise.</li>
<li><code>c(filename)</code> returns a string containing the filename last specified with a use or save, such as <code>"C:\Data\auto.dta"</code>.</li>
<li><code>c(filedate)</code> returns a string containing the date and time the file in <code>c(filename)</code> was last saved, such as “7 Jul 2016 13:51”.</li>
</ul>
<section id="if1" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="if1"><span class="header-section-number">1.5.1</span> <code>if</code></h3>
<p>Mit <code>if (</code>local<code>== "...")</code> können wir macros abgleichen, um Befehle nur unter bestimmten Bedingungen auszuführen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">"`c(username)'"</span> == <span class="st">"Filser"</span>)  <span class="kw">display</span> <span class="st">"Du bist Filser"</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">"`c(username)'"</span> != <span class="st">"Fischer"</span>) <span class="kw">display</span> <span class="st">"Du bist nicht Fischer"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das können wir für den Fall von eben mit mehreren Nutzern nutzen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">"`c(username)'"</span> == <span class="st">"Alex"</span>)   glo pfad <span class="st">"C:\Projekte\Micha"</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">"`c(username)'"</span> == <span class="st">"Micha"</span>)  glo pfad <span class="st">"D:\Arbeit\Alex"</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>glo prog <span class="st">"${pfad}/prog"</span>  </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">data</span> <span class="st">"${pfad}/data"</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">log</span>  <span class="st">"${pfad}/log"</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"${pfad}/BIBBBAuA_2018_suf1.0.dta"</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für <code>if</code>-Bedingungen stehen uns die üblichen Operatoren zur Verfügung, die wir auch aus den <code>if</code>-Statements in Befehlen kennen: <code>&gt;</code>, <code>&lt;</code>, <code>==</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>/<code>~=</code> (ungleich) Mit <code>|</code> können wir <em>oder</em>-Bedingungen stellen.</p>
<ul>
<li><code>inrange</code>: einen Wertebereich auswählen</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>loc x = 20</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`x'</span> &gt;= 20 &amp; <span class="ot">`x'</span> &lt;= 30 <span class="kw">display</span> <span class="st">"&amp; yes"</span>  </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inrange</span>(<span class="ot">`x'</span>,20,30) <span class="kw">display</span> <span class="st">"inrange yes"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>loc x = 19</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inrange</span>(<span class="ot">`x'</span>,20,30) <span class="kw">display</span> <span class="st">"yes"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>inlist</code>: spezifische Werte angeben, um lange Folgen von <code>|</code> zu vermeiden:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>loc x = 20</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`x'</span> == 18 | <span class="ot">`x'</span> == 20 | <span class="ot">`x'</span> == 22 | <span class="ot">`x'</span> == 28 <span class="kw">display</span> <span class="st">"| yes"</span>  </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inlist</span>(<span class="ot">`x'</span>,18,20,22,28) <span class="kw">display</span> <span class="st">"inlist yes"</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="macros-als-variablennamen-und-befehle" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="macros-als-variablennamen-und-befehle"><span class="header-section-number">1.5.2</span> Macros als Variablennamen und Befehle</h3>
<p>Auch so etwas ist möglich:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> n 200</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>su F<span class="ot">`n'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        F200 |     17,953    36.24272    14.03048          1         99</code></pre>
</div>
</div>
<p>Ein macro kann auch ein Programm sein:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>loc t <span class="kw">tab</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="ot">`t'</span> mobil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Mobilfunkin |
    terview |      Freq.     Percent        Cum.
------------+-----------------------------------
   Festnetz |     14,008       70.00       70.00
  Mobilfunk |      6,004       30.00      100.00
------------+-----------------------------------
      Total |     20,012      100.00</code></pre>
</div>
</div>
<p><span class="math inline">\(\Rightarrow\)</span> sollen macros als Text verstanden werden, sind <code>""</code> nötig:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>loc opt ja</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inlist</span>(<span class="ot">`opt'</span>,<span class="st">"ja"</span>,<span class="st">"JA"</span>,<span class="st">"Ja"</span>,<span class="st">"ok"</span>) <span class="kw">tab</span> mobil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ja not found
r(111);

end of do-file
r(111);</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>loc opt ja</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inlist</span>(<span class="st">"`opt'"</span>,<span class="st">"ja"</span>,<span class="st">"JA"</span>,<span class="st">"Ja"</span>,<span class="st">"ok"</span>) <span class="kw">tab</span> mobil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Mobilfunkin |
    terview |      Freq.     Percent        Cum.
------------+-----------------------------------
   Festnetz |     14,008       70.00       70.00
  Mobilfunk |      6,004       30.00      100.00
------------+-----------------------------------
      Total |     20,012      100.00</code></pre>
</div>
</div>
</section>
<section id="allglo" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="allglo"><span class="header-section-number">1.5.3</span> <code>globals</code> durchsuchen</h3>
<p>Mit Hilfe sog. Wildcards können wir Zeichen “offen lassen”:</p>
<ul>
<li><code>?</code> ersetzt ein Zeichen</li>
<li><code>*</code> mehrere oder keines</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>glo x1 = 2</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">x2</span> <span class="st">"das ist x2"</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>glo x 291</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> allglo:  <span class="ot">all</span> globals <span class="st">"x*"</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> allglo2: <span class="ot">all</span> globals <span class="st">"x?"</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">l</span> allglo2 allglo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>allglo2:        x2 x1
allglo:         x x2 x1</code></pre>
</div>
</div>
<p>Hier haben wir auch schon die dritte Form der macro Definition kennengelernt, die sog. <code>extended macro function</code>, welche auf <code>:</code> folgt. Hier also <code>all globals</code>, im Laufe dieses Kurses werden wir noch zahlreiche dieser Funktionen kennenlernen.</p>
</section>
</section>
<section id="wenn-nicht-if-dann-else" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="wenn-nicht-if-dann-else"><span class="header-section-number">1.6</span> Wenn nicht <code>if</code>, dann <code>else</code></h2>
<p>Mit <code>if</code> haben wir die Möglichkeiten aber noch nicht ausgeschöpft - aus <code>help if</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`n'</span>==1 {</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">"one"</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="ot">`n'</span>==2 {</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">"two"</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="ot">`n'</span>==3 {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">"three"</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> {</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">"big"</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">"`word'"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="unterbrechen-wenn-ein-fehler-vorliegt" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="unterbrechen-wenn-ein-fehler-vorliegt"><span class="header-section-number">1.7</span> Unterbrechen wenn ein Fehler vorliegt</h2>
<p>Mit <code>exit</code> (<code>help exit_program</code>) können wir Stata zu einer Unterbrechung bringen:</p>
<blockquote class="blockquote">
<p><code>exit</code> causes Stata to terminate the current process and returns control to the calling process.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="st">"`c(username)'"</span> == <span class="st">"Alex"</span> {</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  glo pfad <span class="st">"C:\Projekte\Micha"</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="st">"`c(username)'"</span> == <span class="st">"Micha"</span> {</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  glo pfad <span class="st">"D:\Arbeit\Alex"</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> {</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a> <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="st">"Hier fehlt der passende Pfad"</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a> <span class="kw">exit</span> </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> mobil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hier fehlt der passende Pfad

end of do-file</code></pre>
</div>
</div>
<hr>
<p><strong><a href="#ue1">Übung</a></strong></p>
<hr>
</section>
<section id="schleifen-foreach-forvalues" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="schleifen-foreach-forvalues"><span class="header-section-number">1.8</span> Schleifen: <code>foreach</code> &amp; <code>forvalues</code></h2>
<p>Schleifen helfen uns das DRY (“Don’t repeat yourself”) Prinzip umzusetzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= 19</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= 24</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= 29</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)29 {</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">"Alter bis `v'"</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= <span class="ot">`v'</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ein vereinfachtes Syntaxdiagramm der <code>foreach</code>-Schleife sieht so aus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> listtype <span class="ot">list</span> {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  Befehle</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>lname</code> steht dabei für ein <code>local</code> macro.</p>
<p>Wir können unterschiedliche Typen von <code>foreach</code>-Listen verwenden:</p>
<p>– <code>of varlist</code>: Variablenlisten<br>
– <code>of newlist</code>: neue Variablen<br>
– <code>of numlist</code>: Nummernlisten - bspw. <code>(0(1)5)</code> <span class="math inline">\(\Rightarrow\)</span> “1 bis 5 in Schritten von 1” <a href="https://www.stata.com/manuals13/pnumlist.pdf">weitere Varianten</a><br>
– <code>in</code>: beliebige Listen von Buchstaben, Zahlen oder Wörtern (durch Leerzeichen getrennt)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">in</span> any_list {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> <span class="kw">local</span>    <span class="kw">local</span>      {</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> <span class="kw">global</span>   <span class="kw">global</span>     {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> <span class="kw">varlist</span>  variablen  { <span class="co">//auch Wildcards möglich - analog zu d F2**</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> newlist  newvarlist { <span class="co">//wenn variablen erst generiert werden</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> numlist  numlist    {</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 1/3 6(1)9  {</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"`n'"</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
2
3
6
7
8
9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 6 4: -4  {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"`n'"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6
4
2
0
-2
-4</code></pre>
</div>
</div>
<section id="ferest" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="ferest"><span class="header-section-number">1.8.1</span> <code>ferest()</code></h3>
<p>Mit <code>ferest()</code> können wir uns die “noch übrigen Werte in der Liste anzeigen lassen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 1(1)5 {</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"`n'"</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"Es kommen noch: `ferest()'"</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
Es kommen noch: 2 3 4 5
2
Es kommen noch: 3 4 5
3
Es kommen noch: 4 5
4
Es kommen noch: 5
5
Es kommen noch: </code></pre>
</div>
</div>
</section>
<section id="weitere-schleifentypen" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="weitere-schleifentypen"><span class="header-section-number">1.8.2</span> Weitere Schleifentypen</h3>
<p>Es gibt außerdem <code>forvalues</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">lname</span>=<span class="kw">range</span> {</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  Befehle</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>forvalues</code>-Schleife ist eine <code>foreach</code>-Schleife mit <code>numlist</code>. Aber: Die <code>foreach</code>-Schleife mit einer <code>numlist</code> funktioniert nicht mit einer beliebig hohen Anzahl von Ziffern. In der <code>forvalues</code>-Schleife gibt es keine Beschränkung. Außerdem ist <code>forvalues</code>-Schleife schneller im Abarbeiten von Nummernlisten.</p>
<p>Und dann gibt es noch die <code>while</code>-Schleife:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>loc i = 1</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ot">`i'</span> &lt;= 5 {</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span> <span class="st">"`i'"</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  loc i = <span class="ot">`i'</span> + 1</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
2
3
4
5</code></pre>
</div>
</div>
<p>Eine Besonderheit bei <code>local</code>s ist, dass wir mit <code>loc ++i</code> den Wert um 1 erhöhen können. Somit führt folgende Syntax zum gleichen Ergebnis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>loc i = 1</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ot">`i'</span> &lt;= 5 {</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span> <span class="st">"`i'"</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  loc ++i</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="anwendung" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="anwendung"><span class="header-section-number">1.8.3</span> Anwendung</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">"Alter bis `v'"</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= <span class="ot">`v'</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Alter bis 19

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |         41       67.21       67.21
   weiblich |         20       32.79      100.00
------------+-----------------------------------
      Total |         61      100.00
Alter bis 24

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        373       65.10       65.10
   weiblich |        200       34.90      100.00
------------+-----------------------------------
      Total |        573      100.00
Alter bis 29

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        991       60.46       60.46
   weiblich |        648       39.54      100.00
------------+-----------------------------------
      Total |      1,639      100.00
Alter bis 34

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |      1,984       59.03       59.03
   weiblich |      1,377       40.97      100.00
------------+-----------------------------------
      Total |      3,361      100.00</code></pre>
</div>
</div>
<p>…oder mit <code>inrange()</code>, um lediglich die 5-Jahresaltersgruppe anzuzeigen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">"Alter "</span> <span class="ot">`v'</span> - 4 <span class="st">" bis "</span> <span class="ot">`v'</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> <span class="fu">inrange</span>(zpalter,<span class="ot">`v'</span>-4, <span class="ot">`v'</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    *su zpalter <span class="kw">if</span> <span class="fu">inrange</span>(zpalter,<span class="ot">`v'</span>-4, <span class="ot">`v'</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Alter 15 bis 19

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |         41       67.21       67.21
   weiblich |         20       32.79      100.00
------------+-----------------------------------
      Total |         61      100.00
Alter 20 bis 24

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        332       64.84       64.84
   weiblich |        180       35.16      100.00
------------+-----------------------------------
      Total |        512      100.00
Alter 25 bis 29

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        618       57.97       57.97
   weiblich |        448       42.03      100.00
------------+-----------------------------------
      Total |      1,066      100.00
Alter 30 bis 34

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        993       57.67       57.67
   weiblich |        729       42.33      100.00
------------+-----------------------------------
      Total |      1,722      100.00</code></pre>
</div>
</div>
</section>
<section id="schleifen-aufbauen" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="schleifen-aufbauen"><span class="header-section-number">1.8.4</span> Schleifen aufbauen</h3>
<p>Einfache Schleife mit <code>if</code>/<code>else</code>: ist Zahl gerade oder ungerade?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>loc n = 5</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">trunc</span>(<span class="ot">`n'</span>/2) == <span class="ot">`n'</span>/2 <span class="kw">display</span> <span class="st">"ja"</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">trunc</span>(<span class="ot">`n'</span>/2) != <span class="ot">`n'</span>/2 <span class="kw">display</span> <span class="st">"nein"</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>loc n = 5</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>dis <span class="fu">mod</span>(<span class="ot">`n'</span>,2) </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n = 1/10 {</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n'</span>,2)  == 0 dis <span class="st">"`n' ist gerade"</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n'</span>,2)  &gt;  0  dis <span class="st">"`n' ist ungerade"</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n = 1/10 {</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n'</span>,2)  == 0 {</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        dis <span class="st">"`n' ist gerade"</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> <span class="kw">if</span> <span class="fu">mod</span>(<span class="ot">`n'</span>,2)  &gt; 0 {</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>        dis <span class="st">"`n' ist ungerade"</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://de.wikipedia.org/wiki/Division_mit_Rest#Modulo">mod() ist der Modulo-Operator in Stata - es wird der “Rest” berechnet</a></p>
</section>
<section id="nested-loop" class="level3" data-number="1.8.5">
<h3 data-number="1.8.5" class="anchored" data-anchor-id="nested-loop"><span class="header-section-number">1.8.5</span> nested loop</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n1 = 1/3 {</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">forvalues</span> n2 = 1/3 {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">"n1 ist `n1' und n2 ist `n2' "</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n1 ist 1 und n2 ist 1 
n1 ist 1 und n2 ist 2 
n1 ist 1 und n2 ist 3 
n1 ist 2 und n2 ist 1 
n1 ist 2 und n2 ist 2 
n1 ist 2 und n2 ist 3 
n1 ist 3 und n2 ist 1 
n1 ist 3 und n2 ist 2 
n1 ist 3 und n2 ist 3 </code></pre>
</div>
</div>
</section>
<section id="display-vs.-macro-list" class="level3" data-number="1.8.6">
<h3 data-number="1.8.6" class="anchored" data-anchor-id="display-vs.-macro-list"><span class="header-section-number">1.8.6</span> <code>display</code> vs.&nbsp;<code>macro list</code></h3>
<p><code>macro list</code> stoppt das DoFile wenn der macro nicht existiert, <code>display</code> zeigt nur ein leeres Feld an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> labormarket LABOUR</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">"${labormarket}"</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">"${labourmarket}"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>LABOUR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> labormarket</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> labourmarket</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>labormarket:    LABOUR</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> <span class="kw">macro</span> <span class="ot">$labourmarket</span> <span class="kw">not</span> found</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">r</span>(111);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><strong><a href="#ue2">Übung</a></strong></p>
<hr>
<!-- - Variablen & value labels anzeigen/bearbeiten  -->
<!-- - Creating interaction variables -->
<!-- - Fitting models with alternative measures of education -->
<!-- - Recoding multiple variables the same way -->
<!-- - Creating a macro that holds accumulated information -->
<!-- - Retrieving information returned by Stata -->
</section>
</section>
<section id="übungen" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="übungen"><span class="header-section-number">1.9</span> Übungen</h2>
<section id="ue0" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="ue0"><span class="header-section-number">1.9.1</span> Übung</h3>
<ul>
<li>Was ist das Ergebnis dieser Rechnung? Nehmen Sie sich einen Moment Zeit und rechnen Sie im Kopf - Überprüfen Sie dann ihr Ergebnis.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>loc x = 4</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">y</span> = 1+5</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> 1+5</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">`x'</span> * <span class="ot">`y'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Wie können Sie hier aus <code>Hallo zusammen! :-)</code> folgende Ausgabe machen: <code>Hallo, zusammen! :-)</code> ohne die macros zu verändern oder einen neuen anzulegen?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>glo t1 <span class="st">"Hallo"</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>glo t2 <span class="st">" zusammen"</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>glo t3 <span class="st">"! :-)"</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>glo t4 = <span class="st">"${t1}${t2}${t3}"</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>dis <span class="st">"${t4}"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ue1" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="ue1"><span class="header-section-number">1.9.2</span> Übung</h3>
<ul>
<li>Pfad zusammenbauen für <code>use</code>: Erstellen Sie den Pfad für den <code>use</code>-Befehl schrittweise und unter Berücksichtigung Ihres Usernamens.
<ul>
<li>ggf. Dateiverzeichnis einrichten mit Ordner <em>log</em>, <em>prog</em> und <em>data</em> (gerne auch mehr oder andere Namen)</li>
<li>Legen Sie die Erwerbstätigenbefragung 2018 in den <em>data</em>-Ordner (oder dessen Äquivalent)</li>
<li>Wie ist der Username auf Ihrem Gerät?</li>
<li>Verwenden Sie ein <code>if</code>-Statement, um den Dateipfad zu erstellen</li>
<li>Erstellen Sie ein LogFile, welches das heutige Datum im Namen trägt.</li>
</ul></li>
<li>Lassen Sie sich alle <code>globals</code>, die mit “S” beginnen, in ein <code>gobal allS</code> ablegen. Was wurde alles gefunden?
<ul>
<li>Denken Sie an die <code>extended macro function</code> <a href="#allglo"><code>all globals</code></a></li>
<li>Wie könnten Sie eine Schleife bauen, die nacheinander alle <code>globals</code> anzeigt, die mit “S” beginnen?</li>
</ul></li>
</ul>
</section>
<section id="ue2" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="ue2"><span class="header-section-number">1.9.3</span> FizzBuzz-Challenge</h3>
<p>Fizz Buzz wird/wurde als ein Screening-Instrument für Programmierer*innen verwendet. Fizz Buzz ist ein Kinderlernspiel, bei dem die Kinder üblicherweise im Kreis sitzen und reihum laut von eins aufwärts zählen. Allerdings gibt es drei Regeln:</p>
<ul>
<li>Alle Zahlen, die durch drei teilbar sind, müssen durch das Wort “Fizz” ersetzt werden</li>
<li>Alle Zahlen, die durch fünf teilbar sind, müssen durch das Wort “Buzz” ersetzt werden</li>
<li>Wenn eine Zahl durch drei und fünf teilbar ist, dann wird “Fizz Buzz” gerufen.</li>
</ul>
<p>Wie würden Sie mit <code>if</code> &amp; <code>else</code> eine Schleife bauen, welche diese Regeln umsetzt. Was wäre der erste Schritt? Bauen Sie dann die Schleife und lassen Sie die Schleife für den Wertebereich 0-30 laufen.</p>
</section>
<section id="ue3" class="level3" data-number="1.9.4">
<h3 data-number="1.9.4" class="anchored" data-anchor-id="ue3"><span class="header-section-number">1.9.4</span> Übung</h3>
<p>Passen Sie die Schleife mit <a href="#ferest"><code>ferest()</code></a> an, sodass hier im 5. Durchlauf nicht mehr <code>Es kommen noch:</code> steht, sondern <code>Fertig</code>.</p>
</section>
</section>
<section id="anhang" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="anhang"><span class="header-section-number">1.10</span> Anhang</h2>
<section id="dir" class="level3" data-number="1.10.1">
<h3 data-number="1.10.1" class="anchored" data-anchor-id="dir"><span class="header-section-number">1.10.1</span> Windows Dateipfade mit macros</h3>
<p><a href="https://www.stata.com/manuals/u18.pdf#u18.3.11">Aus der Stata-Doku zu macros</a>:</p>
<p>Stata uses the &nbsp;character to tell its parser not to expand macros. Windows uses the &nbsp;character as the directory path separator. Mostly, there is no problem using a &nbsp;in a filename. However, if you are writing a program that contains a Windows path in macro path and a filename in fname, do not assemble the final result as <code>‘path’\‘fname’</code> because Stata will interpret the &nbsp;as an instruction to not expand <code>‘fname’</code>. <span class="math inline">\(\Rightarrow\)</span> Instead, assemble the final result as <code>‘path’/‘fname’</code>. Stata understands <code>/</code> as a directory separator on all platforms.</p>
</section>
<section id="debugging-wo-ist-der-wurm-drin" class="level3" data-number="1.10.2">
<h3 data-number="1.10.2" class="anchored" data-anchor-id="debugging-wo-ist-der-wurm-drin"><span class="header-section-number">1.10.2</span> Debugging: Wo ist der Wurm drin?</h3>
<p>Fehlersuch in langen <code>foreach</code>-Schleifen kann mühsam und nervig sein. in many cases you would like to go throuh the code step by step then, however, the value of the loop index (which is a <code>local</code>) In vielen Fällen möchte man den Code Schritt für Schritt durchgehen, dann aber den Wert des Schleifen-<code>locals</code> ist natürlich nach Abbruch der Schleife nicht mehr da.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">y</span> = 1982/1985 {</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="st">"${data}/wages-year`y'"</span>, <span class="kw">clear</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">capture</span> <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span> <span class="kw">using</span> <span class="st">"${data}/log`y'.log"</span>, <span class="bn">text</span> <span class="kw">replace</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">regress</span> lwage exper expersq educ</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">avplots</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"${graph}/avplots`y'.png"</span>, <span class="kw">replace</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Manchmal hilft ein einfacher Workaround: ein <code>global</code> aus dem <code>local</code> definieren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">y</span> = 1982/1985 {</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> Y = <span class="ot">`y'</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="st">"${data}/wages-year`y'"</span>, <span class="kw">clear</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">capture</span> <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span> <span class="kw">using</span> <span class="st">"${data}/log`y'.log"</span>, <span class="bn">text</span> <span class="kw">replace</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">regress</span> lwage exper expersq educ</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">avplots</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"${graph}/avplots`y'.png"</span>, <span class="kw">replace</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternativ hilft häufig auch <code>set trace on</code> weiter. Hier werden immer die zuerst die macros und dann die eingesetzten Werte angezeigt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="fu">trace</span> <span class="kw">on</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">"Alter "</span> <span class="ot">`v'</span> - 4 <span class="st">" bis "</span> <span class="ot">`v'</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>- foreach v of numlist 19(5)35 {
- display "Alter " `v' - 4 " bis " `v'
= display "Alter " 19 - 4 " bis " 19
Alter 15 bis 19
- }
- display "Alter " `v' - 4 " bis " `v'
= display "Alter " 24 - 4 " bis " 24
Alter 20 bis 24
- }
- display "Alter " `v' - 4 " bis " `v'
= display "Alter " 29 - 4 " bis " 29
Alter 25 bis 29
- }
- display "Alter " `v' - 4 " bis " `v'
= display "Alter " 34 - 4 " bis " 34
Alter 30 bis 34
- }</code></pre>
</div>
</div>
</section>
<section id="einstellung-für-ssc-install-an-bibb-arbeitsrechnern" class="level3" data-number="1.10.3">
<h3 data-number="1.10.3" class="anchored" data-anchor-id="einstellung-für-ssc-install-an-bibb-arbeitsrechnern"><span class="header-section-number">1.10.3</span> Einstellung für <code>ssc install</code> an BIBB-Arbeitsrechnern</h3>
<p>HTTP proxy host: <code>kessenich.ivbb.bund.de</code> Port: <code>80</code></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./pics/02_install.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<!-- ### `local x` entspricht `global _x` -->
<!-- Theoretisch kann man auch mit `global _x` einen `local x` erzeugen: -->
<!-- ```{stata det0a, eval= F} -->
<!-- local   x = 2 -->
<!-- global _x = 3 -->
<!-- dis  -->
<!-- ``` -->
<!-- ```{stata det0b, eval= F} -->
<!-- local i=1  -->
<!-- global _i=1 -->
<!-- ``` -->
<!-- Damit könnte man auch so alle `locals` auflisten: -->
<!-- ```{stata alllocas, eval = F} -->
<!-- glo x1 = 2 -->
<!-- glo x2 "das ist x2" -->
<!-- glo x 291 -->
<!-- global allglo:  all globals "_x*" -->
<!-- mac l allglo -->
<!-- ``` -->
<!-- ```{stata det1, eval= F} -->
<!-- global a "myvar" -->
<!-- gen $a = oldvar   gen myvar = oldvar -->
<!-- gen a = oldvar    gen a = oldvar -->
<!-- local a "myvar" -->
<!-- gen ‘a’ = oldvar gen myvar = oldvar -->
<!-- gen a = oldvar gen a = oldvar -->
<!-- global a "newvar" -->
<!-- global i = 2 -->
<!-- gen $a$i = oldvar gen newvar2 = oldvar -->
<!-- local a "newvar" -->
<!-- local i = 2 -->
<!-- gen ‘a’‘i’ = oldvar gen newvar2 = oldvar -->
<!-- global b1 "newvar" -->
<!-- global i=1 -->
<!-- gen ${b$i} = oldvar gen newvar = oldvar -->
<!-- local b1 "newvar" -->
<!-- local i=1 -->
<!-- gen ‘b‘i’’ = oldvar gen newvar = oldvar -->
<!-- global b1 "newvar" -->
<!-- global a "b" -->
<!-- global i = 1 -->
<!-- gen ${$a$i} = oldvar gen newvar = oldvar -->
<!-- local b1 "newvar" -->
<!-- local a "b" -->
<!-- local i = 1 -->
<!-- gen ‘‘a’‘i’’ = oldvar gen newvar = oldvar -->
<!-- ``` -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>

<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Herzlich Willkommen</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02_loops_fromdata.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Schleifen aus Macros</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Alle Kursinhalte <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> 2022 von <a href="https://afilser.netlify.app/">Andreas Filser</a><br> <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC Lizenz mit Namensnennung <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-by" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-nc" aria-hidden="true"></i></a><br> Erstellt mit <i class="fa-brands fa-r-project" aria-hidden="true"></i> &amp; <a href="https://www.ssc.wisc.edu/~hemken/Stataworkshops/Statamarkdown/stata-and-r-markdown.html">Statamarkdown</a>, Code <a href="https://github.com/filius23/StataBIBB_tables2022">hier einsehbar <i class="fa-brands fa-github" aria-hidden="true"></i></a></div>
  </div>
</footer>



</body></html>