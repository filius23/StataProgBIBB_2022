<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Macros | Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Macros | Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Macros | Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Andreas Filser" />


<meta name="date" content="2022-09-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="loopmacro.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stata @ BIBB</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Herzlich Willkommen</a></li>
<li class="chapter" data-level="1" data-path="macro.html"><a href="macro.html"><i class="fa fa-check"></i><b>1</b> Macros</a>
<ul>
<li class="chapter" data-level="1.1" data-path="macro.html"><a href="macro.html#macht-einen-unterschied"><i class="fa fa-check"></i><b>1.1</b> <code>=</code> macht einen Unterschied</a></li>
<li class="chapter" data-level="1.2" data-path="macro.html"><a href="macro.html#local-und-global-sind-getrennte-welten"><i class="fa fa-check"></i><b>1.2</b> <code>local</code> und <code>global</code> sind getrennte Welten</a></li>
<li class="chapter" data-level="1.3" data-path="macro.html"><a href="macro.html#macros-mit-text"><i class="fa fa-check"></i><b>1.3</b> Macros mit Text</a></li>
<li class="chapter" data-level="1.4" data-path="macro.html"><a href="macro.html#dateipfade"><i class="fa fa-check"></i><b>1.4</b> Dateipfade</a></li>
<li class="chapter" data-level="1.5" data-path="macro.html"><a href="macro.html#cmac"><i class="fa fa-check"></i><b>1.5</b> Bereits definierte Macros</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="macro.html"><a href="macro.html#if1"><i class="fa fa-check"></i><b>1.5.1</b> <code>if</code></a></li>
<li class="chapter" data-level="1.5.2" data-path="macro.html"><a href="macro.html#macros-als-variablennamen-und-befehle"><i class="fa fa-check"></i><b>1.5.2</b> Macros als Variablennamen und Befehle</a></li>
<li class="chapter" data-level="1.5.3" data-path="macro.html"><a href="macro.html#allglo"><i class="fa fa-check"></i><b>1.5.3</b> <code>globals</code> durchsuchen</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="macro.html"><a href="macro.html#wenn-nicht-if-dann-else"><i class="fa fa-check"></i><b>1.6</b> Wenn nicht <code>if</code>, dann <code>else</code></a></li>
<li class="chapter" data-level="1.7" data-path="macro.html"><a href="macro.html#unterbrechen-wenn-ein-fehler-vorliegt"><i class="fa fa-check"></i><b>1.7</b> Unterbrechen wenn ein Fehler vorliegt</a></li>
<li class="chapter" data-level="1.8" data-path="macro.html"><a href="macro.html#schleifen-foreach-forvalues"><i class="fa fa-check"></i><b>1.8</b> Schleifen: <code>foreach</code> &amp; <code>forvalues</code></a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="macro.html"><a href="macro.html#ferest"><i class="fa fa-check"></i><b>1.8.1</b> <code>ferest()</code></a></li>
<li class="chapter" data-level="1.8.2" data-path="macro.html"><a href="macro.html#weitere-schleifentypen"><i class="fa fa-check"></i><b>1.8.2</b> Weitere Schleifentypen</a></li>
<li class="chapter" data-level="1.8.3" data-path="macro.html"><a href="macro.html#anwendung"><i class="fa fa-check"></i><b>1.8.3</b> Anwendung</a></li>
<li class="chapter" data-level="1.8.4" data-path="macro.html"><a href="macro.html#schleifen-aufbauen"><i class="fa fa-check"></i><b>1.8.4</b> Schleifen aufbauen</a></li>
<li class="chapter" data-level="1.8.5" data-path="macro.html"><a href="macro.html#nested-loop"><i class="fa fa-check"></i><b>1.8.5</b> nested loop</a></li>
<li class="chapter" data-level="1.8.6" data-path="macro.html"><a href="macro.html#display-vs.-macro-list"><i class="fa fa-check"></i><b>1.8.6</b> <code>display</code> vs. <code>macro list</code></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="macro.html"><a href="macro.html#übungen"><i class="fa fa-check"></i><b>1.9</b> Übungen</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="macro.html"><a href="macro.html#ue0"><i class="fa fa-check"></i><b>1.9.1</b> Übung</a></li>
<li class="chapter" data-level="1.9.2" data-path="macro.html"><a href="macro.html#ue1"><i class="fa fa-check"></i><b>1.9.2</b> Übung</a></li>
<li class="chapter" data-level="1.9.3" data-path="macro.html"><a href="macro.html#ue2"><i class="fa fa-check"></i><b>1.9.3</b> FizzBuzz-Challenge</a></li>
<li class="chapter" data-level="1.9.4" data-path="macro.html"><a href="macro.html#ue3"><i class="fa fa-check"></i><b>1.9.4</b> Übung</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="macro.html"><a href="macro.html#anhang"><i class="fa fa-check"></i><b>1.10</b> Anhang</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="macro.html"><a href="macro.html#dir"><i class="fa fa-check"></i><b>1.10.1</b> Windows Dateipfade mit macros</a></li>
<li class="chapter" data-level="1.10.2" data-path="macro.html"><a href="macro.html#debugging-wo-ist-der-wurm-drin"><i class="fa fa-check"></i><b>1.10.2</b> Debugging: Wo ist der Wurm drin?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="loopmacro.html"><a href="loopmacro.html"><i class="fa fa-check"></i><b>2</b> Schleifen aus Macros</a>
<ul>
<li class="chapter" data-level="2.1" data-path="loopmacro.html"><a href="loopmacro.html#local-erstellen-und-für-schleifen-verwenden"><i class="fa fa-check"></i><b>2.1</b> local erstellen und für Schleifen verwenden</a></li>
<li class="chapter" data-level="2.2" data-path="loopmacro.html"><a href="loopmacro.html#schleifen-über-strings"><i class="fa fa-check"></i><b>2.2</b> Schleifen über strings</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="loopmacro.html"><a href="loopmacro.html#wörter-indizieren"><i class="fa fa-check"></i><b>2.2.1</b> Wörter indizieren</a></li>
<li class="chapter" data-level="2.2.2" data-path="loopmacro.html"><a href="loopmacro.html#wörter-zählen"><i class="fa fa-check"></i><b>2.2.2</b> Wörter zählen</a></li>
<li class="chapter" data-level="2.2.3" data-path="loopmacro.html"><a href="loopmacro.html#wörter-in-schleife"><i class="fa fa-check"></i><b>2.2.3</b> Wörter in Schleife</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="loopmacro.html"><a href="loopmacro.html#informationen-aus-schleifen-behalten"><i class="fa fa-check"></i><b>2.3</b> Informationen aus Schleifen behalten</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="loopmacro.html"><a href="loopmacro.html#gespeichterte-ergebnisse"><i class="fa fa-check"></i><b>2.3.1</b> Gespeichterte Ergebnisse</a></li>
<li class="chapter" data-level="2.3.2" data-path="loopmacro.html"><a href="loopmacro.html#e-und-r-sind-getrennte-welten"><i class="fa fa-check"></i><b>2.3.2</b> <code>e()</code> und <code>r()</code> sind getrennte Welten</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="loopmacro.html"><a href="loopmacro.html#ergebnisse-weiter-verwenden"><i class="fa fa-check"></i><b>2.4</b> Ergebnisse weiter verwenden</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="loopmacro.html"><a href="loopmacro.html#recur"><i class="fa fa-check"></i><b>2.4.1</b> Rekursivität</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="loopmacro.html"><a href="loopmacro.html#mat1"><i class="fa fa-check"></i><b>2.5</b> Kennzahlen in einer <code>matrix</code> ablegen</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="loopmacro.html"><a href="loopmacro.html#namen-für-spalten-und-zeilen-einer-matrix"><i class="fa fa-check"></i><b>2.5.1</b> Namen für Spalten und Zeilen einer <code>matrix</code></a></li>
<li class="chapter" data-level="2.5.2" data-path="loopmacro.html"><a href="loopmacro.html#mcollect"><i class="fa fa-check"></i><b>2.5.2</b> <code>matrix</code> erstellen</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="loopmacro.html"><a href="loopmacro.html#labels-behalten"><i class="fa fa-check"></i><b>2.6</b> Labels behalten</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="loopmacro.html"><a href="loopmacro.html#labfun"><i class="fa fa-check"></i><b>2.6.1</b> <code>extended macro function</code> für Labels</a></li>
<li class="chapter" data-level="2.6.2" data-path="loopmacro.html"><a href="loopmacro.html#mrown"><i class="fa fa-check"></i><b>2.6.2</b> Labels als <code>rowname</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="loopmacro.html"><a href="loopmacro.html#von-der-matrix-zum-datensatz"><i class="fa fa-check"></i><b>2.7</b> Von der <code>matrix</code> zum Datensatz</a></li>
<li class="chapter" data-level="2.8" data-path="loopmacro.html"><a href="loopmacro.html#frame"><i class="fa fa-check"></i><b>2.8</b> <code>frame</code>: mehrere Datensätze in Stata</a></li>
<li class="chapter" data-level="2.9" data-path="loopmacro.html"><a href="loopmacro.html#übungen-1"><i class="fa fa-check"></i><b>2.9</b> Übungen</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="loopmacro.html"><a href="loopmacro.html#loop1"><i class="fa fa-check"></i><b>2.9.1</b> Übung</a></li>
<li class="chapter" data-level="2.9.2" data-path="loopmacro.html"><a href="loopmacro.html#retue1"><i class="fa fa-check"></i><b>2.9.2</b> Übung</a></li>
<li class="chapter" data-level="2.9.3" data-path="loopmacro.html"><a href="loopmacro.html#retue2"><i class="fa fa-check"></i><b>2.9.3</b> Übung</a></li>
<li class="chapter" data-level="2.9.4" data-path="loopmacro.html"><a href="loopmacro.html#retue3"><i class="fa fa-check"></i><b>2.9.4</b> Übung</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regres.html"><a href="regres.html"><i class="fa fa-check"></i><b>3</b> Regressionsergebnisse weiterverarbeiten</a>
<ul>
<li class="chapter" data-level="3.1" data-path="regres.html"><a href="regres.html#e-und-r-der-regressionsergebnisse"><i class="fa fa-check"></i><b>3.1</b> <code>e()</code> und <code>r()</code> der Regressionsergebnisse</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="regres.html"><a href="regres.html#koeffizienten-mit-_b-_se-aufrufen"><i class="fa fa-check"></i><b>3.1.1</b> Koeffizienten mit <code>_b</code> / <code>_se</code> aufrufen</a></li>
<li class="chapter" data-level="3.1.2" data-path="regres.html"><a href="regres.html#komplette-regressionstabelle"><i class="fa fa-check"></i><b>3.1.2</b> Komplette Regressionstabelle</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="regres.html"><a href="regres.html#regressionstabellen-als-matrix-speichern-und-anpassen"><i class="fa fa-check"></i><b>3.2</b> Regressionstabellen als <code>matrix</code> speichern und anpassen</a></li>
<li class="chapter" data-level="3.3" data-path="regres.html"><a href="regres.html#kategoriale-uv"><i class="fa fa-check"></i><b>3.3</b> kategoriale UV</a></li>
<li class="chapter" data-level="3.4" data-path="regres.html"><a href="regres.html#als-datensatz-ablegen"><i class="fa fa-check"></i><b>3.4</b> Als Datensatz ablegen:</a></li>
<li class="chapter" data-level="3.5" data-path="regres.html"><a href="regres.html#weitere-infos-aus-e"><i class="fa fa-check"></i><b>3.5</b> weitere Infos aus <code>e()</code></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="regres.html"><a href="regres.html#esample"><i class="fa fa-check"></i><b>3.5.1</b> <code>e(sample)</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="regres.html"><a href="regres.html#reg-schrittweise-aufbauen"><i class="fa fa-check"></i><b>3.6</b> <code>reg</code> schrittweise aufbauen</a></li>
<li class="chapter" data-level="3.7" data-path="regres.html"><a href="regres.html#übungen-2"><i class="fa fa-check"></i><b>3.7</b> Übungen</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="regres.html"><a href="regres.html#reg1"><i class="fa fa-check"></i><b>3.7.1</b> Übung</a></li>
<li class="chapter" data-level="3.7.2" data-path="regres.html"><a href="regres.html#reg2"><i class="fa fa-check"></i><b>3.7.2</b> Übung</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="regres.html"><a href="regres.html#anhang-1"><i class="fa fa-check"></i><b>3.8</b> Anhang</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="regres.html"><a href="regres.html#statsby"><i class="fa fa-check"></i><b>3.8.1</b> <code>statsby</code></a></li>
<li class="chapter" data-level="3.8.2" data-path="regres.html"><a href="regres.html#reg-ergebnisse-für-modelle-sammeln-schleife"><i class="fa fa-check"></i><b>3.8.2</b> <code>reg</code>-Ergebnisse für Modelle sammeln: Schleife</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="labmacro.html"><a href="labmacro.html"><i class="fa fa-check"></i><b>4</b> Label- und Variablenfunktionen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="labmacro.html"><a href="labmacro.html#stringfunktionen"><i class="fa fa-check"></i><b>4.1</b> Stringfunktionen</a></li>
<li class="chapter" data-level="4.2" data-path="labmacro.html"><a href="labmacro.html#arbeiten-mit-regular-expressions"><i class="fa fa-check"></i><b>4.2</b> Arbeiten mit “Regular Expressions”</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="labmacro.html"><a href="labmacro.html#regex-grund-regeln"><i class="fa fa-check"></i><b>4.2.1</b> regex (Grund-)Regeln</a></li>
<li class="chapter" data-level="4.2.2" data-path="labmacro.html"><a href="labmacro.html#beispiele"><i class="fa fa-check"></i><b>4.2.2</b> Beispiele</a></li>
<li class="chapter" data-level="4.2.3" data-path="labmacro.html"><a href="labmacro.html#weiterführende-links"><i class="fa fa-check"></i><b>4.2.3</b> Weiterführende Links</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="labmacro.html"><a href="labmacro.html#labfuns"><i class="fa fa-check"></i><b>4.3</b> Label bearbeiten</a></li>
<li class="chapter" data-level="4.4" data-path="labmacro.html"><a href="labmacro.html#abgleiche"><i class="fa fa-check"></i><b>4.4</b> Abgleiche</a></li>
<li class="chapter" data-level="4.5" data-path="labmacro.html"><a href="labmacro.html#valsearch"><i class="fa fa-check"></i><b>4.5</b> wo kommt überall -4 vor?</a></li>
<li class="chapter" data-level="4.6" data-path="labmacro.html"><a href="labmacro.html#übungen-3"><i class="fa fa-check"></i><b>4.6</b> Übungen</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="labmacro.html"><a href="labmacro.html#strue"><i class="fa fa-check"></i><b>4.6.1</b> Übung</a></li>
<li class="chapter" data-level="4.6.2" data-path="labmacro.html"><a href="labmacro.html#regexue"><i class="fa fa-check"></i><b>4.6.2</b> Übung</a></li>
<li class="chapter" data-level="4.6.3" data-path="labmacro.html"><a href="labmacro.html#varlab"><i class="fa fa-check"></i><b>4.6.3</b> Übung</a></li>
<li class="chapter" data-level="4.6.4" data-path="labmacro.html"><a href="labmacro.html#valuesearch"><i class="fa fa-check"></i><b>4.6.4</b> Übung</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="labmacro.html"><a href="labmacro.html#anhang-2"><i class="fa fa-check"></i><b>4.7</b> Anhang</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Dateien- und DoFile-Verwaltung</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#dir---alles-einlesen"><i class="fa fa-check"></i><b>5.1</b> <code>dir</code> - alles einlesen</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data.html"><a href="data.html#copy"><i class="fa fa-check"></i><b>5.1.1</b> <code>copy</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="data.html"><a href="data.html#erase"><i class="fa fa-check"></i><b>5.1.2</b> <code>erase</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#verzeichnisse-dofiles-erstellen"><i class="fa fa-check"></i><b>5.2</b> Verzeichnisse &amp; DoFiles erstellen</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#master-dofile"><i class="fa fa-check"></i><b>5.3</b> Master DoFile</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data.html"><a href="data.html#dofile-mit-argumenten-starten"><i class="fa fa-check"></i><b>5.3.1</b> DoFile mit Argumenten starten</a></li>
<li class="chapter" data-level="5.3.2" data-path="data.html"><a href="data.html#in-neuer-session-starten"><i class="fa fa-check"></i><b>5.3.2</b> in neuer Session starten</a></li>
<li class="chapter" data-level="5.3.3" data-path="data.html"><a href="data.html#mehrere-sessions-starten"><i class="fa fa-check"></i><b>5.3.3</b> mehrere Sessions starten</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#übungen-4"><i class="fa fa-check"></i><b>5.4</b> Übungen</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data.html"><a href="data.html#dir_readin"><i class="fa fa-check"></i><b>5.4.1</b> Übung</a></li>
<li class="chapter" data-level="5.4.2" data-path="data.html"><a href="data.html#masterdofile"><i class="fa fa-check"></i><b>5.4.2</b> Übung</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#anhang-3"><i class="fa fa-check"></i><b>5.5</b> Anhang</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="misc.html"><a href="misc.html"><i class="fa fa-check"></i><b>6</b> Weitere <code>macro</code> &amp; <code>matrix</code> Funktionen</a>
<ul>
<li class="chapter" data-level="6.1" data-path="misc.html"><a href="misc.html#capture"><i class="fa fa-check"></i><b>6.1</b> <code>capture</code></a></li>
<li class="chapter" data-level="6.2" data-path="misc.html"><a href="misc.html#macro-extended-functions-for-parsing"><i class="fa fa-check"></i><b>6.2</b> Macro extended functions for parsing</a></li>
<li class="chapter" data-level="6.3" data-path="misc.html"><a href="misc.html#weitere-matrix-befehle"><i class="fa fa-check"></i><b>6.3</b> weitere <code>matrix</code>-Befehle</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="misc.html"><a href="misc.html#teilmatrizen"><i class="fa fa-check"></i><b>6.3.1</b> Teilmatrizen</a></li>
<li class="chapter" data-level="6.3.2" data-path="misc.html"><a href="misc.html#spaltenzeilen-auswählen"><i class="fa fa-check"></i><b>6.3.2</b> Spalten/Zeilen auswählen</a></li>
<li class="chapter" data-level="6.3.3" data-path="misc.html"><a href="misc.html#crnumb"><i class="fa fa-check"></i><b>6.3.3</b> Namensbasierte Auswahl</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lit.html"><a href="lit.html"><i class="fa fa-check"></i><b>7</b> Literatur &amp; Links</a></li>
<li class="divider"></li>
<p>Alle Kursinhalte &copy; 2022 von <a href="https://afilser.netlify.app/">Andreas Filser</a><br>
CC Lizenz mit Namensnennung <i class="fab fa-creative-commons"></i> <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a><br>
Code <a href="https://github.com/filius23/StataProgBIBB_2022">hier einsehbar</a> <i class="fab fa-github"></i><br>
<a href="https://github.com/rstudio/bookdown" target="blank">Erstellt mit bookdown</a> und <a href="https://www.ssc.wisc.edu/~hemken/Stataworkshops/Statamarkdown/stata-and-r-markdown.html" target="blank">Statamarkdown</a></p>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stata für Fortgeschrittene: Programmieren mit Postestimates, Macros und Schleifen in Stata</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="macro" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Macros<a href="macro.html#macro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Macros ist die Sammelbezeichung für <code>global</code>s und <code>local</code>s in Stata.
Beide dienen zur (vorläufigen) Speicherung von Text- oder Zahleninformationen.
Definiert werden sie durch <code>global</code><em>inhalt</em> oder <code>local</code><em>inhalt</em> - oft mit <code>glo</code> und <code>loc</code> als Abkürzungen.
<code>global</code>s können dann mit <code>$globalname</code>/<code>${globalname}</code> aufgerufen werden, <code>local</code>s mit `<code>localname'</code> - ganz einfach bspw. mit <code>dis[play]</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb1-1"><a href="macro.html#cb1-1" aria-hidden="true" tabindex="-1"></a>glo x = 1</span>
<span id="cb1-2"><a href="macro.html#cb1-2" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> = 2</span>
<span id="cb1-3"><a href="macro.html#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="macro.html#cb1-4" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">${x}</span></span>
<span id="cb1-5"><a href="macro.html#cb1-5" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">`y&#39;</span></span>
<span id="cb1-6"><a href="macro.html#cb1-6" aria-hidden="true" tabindex="-1"></a>1</span>
<span id="cb1-7"><a href="macro.html#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="macro.html#cb1-8" aria-hidden="true" tabindex="-1"></a>2</span></code></pre></div>
<p>…oder mit <code>macro list</code>, hier sind die macros aber ohne “punctuation” (also <code>$</code> oder `<code>'</code>)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb2-1"><a href="macro.html#cb2-1" aria-hidden="true" tabindex="-1"></a>glo x = 1</span>
<span id="cb2-2"><a href="macro.html#cb2-2" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> = 2</span>
<span id="cb2-3"><a href="macro.html#cb2-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> x</span>
<span id="cb2-4"><a href="macro.html#cb2-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _y</span>
<span id="cb2-5"><a href="macro.html#cb2-5" aria-hidden="true" tabindex="-1"></a>x:              1</span>
<span id="cb2-6"><a href="macro.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="macro.html#cb2-7" aria-hidden="true" tabindex="-1"></a>_y:             2</span></code></pre></div>
<p>Der Unterschied besteht vor allem darin, dass <em>local</em> macros ‘lokal’ für ein spezifisches Programm verfügbar sind, <em>globale</em> macros hingegen für alle Programme (innerhalb einer Stata-Session) verfügbar sind.
Letztlich können wir jede Instanz, in der wir mehrere Zeilen eines DoFiles ausführen als ‘Programm’ ansehen.</p>
<p><code>global</code>s können wir später nochmal aufrufen, <code>local</code>s nicht:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb3-1"><a href="macro.html#cb3-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> xg</span></code></pre></div>
<pre><code>xg:             1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb5-1"><a href="macro.html#cb5-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _xl</span></code></pre></div>
<pre><code>r(111);

end of do-file
r(111);</code></pre>
<div id="macht-einen-unterschied" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> <code>=</code> macht einen Unterschied<a href="macro.html#macht-einen-unterschied" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In der Regel können wir auch einfach <code>glo glname Wert</code> bzw. <code>loc locname Wert</code> statt <code>glo glname = Wert</code> bzw. <code>loc locname = Wert</code> angeben.
Allerdings ist hier etwas Vorsicht geboten, denn das <code>=</code> ist entscheidend ob die Rechnung abgelegt wird oder das Ergebnis (<em>Stichwort evaluation</em>):
+ Mit <code>=</code> : der Ausdruck wird “evaluated”
+ Ohne <code>=</code> : der Ausdruck wird “aliased”</p>
<p>Im Ergebnis sehen wir hier beides Mal das gleiche:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb7-1"><a href="macro.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m1 2+2</span>
<span id="cb7-2"><a href="macro.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m1&#39;</span></span>
<span id="cb7-3"><a href="macro.html#cb7-3" aria-hidden="true" tabindex="-1"></a>4</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb8-1"><a href="macro.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m2 = 2+2</span>
<span id="cb8-2"><a href="macro.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m2&#39;</span></span>
<span id="cb8-3"><a href="macro.html#cb8-3" aria-hidden="true" tabindex="-1"></a>4</span></code></pre></div>
<p>Aber wenn wir uns mit <code>mac list</code> die abgelegten Infos ansehen, dann sehen wir den entscheidenden Unterschied:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb9-1"><a href="macro.html#cb9-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _m1 _m2</span></code></pre></div>
<pre><code>_m1:            2+2
_m2:            4</code></pre>
<p>Wenn wir nämlich mit <code>m1</code> und <code>m2</code> weiterrechnen, da kann folgendes passieren:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb11-1"><a href="macro.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m1 2+2</span>
<span id="cb11-2"><a href="macro.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m1&#39;</span>*4</span>
<span id="cb11-3"><a href="macro.html#cb11-3" aria-hidden="true" tabindex="-1"></a>10</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb12-1"><a href="macro.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> m2 = 2+2</span>
<span id="cb12-2"><a href="macro.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="ot">`m2&#39;</span>*4</span>
<span id="cb12-3"><a href="macro.html#cb12-3" aria-hidden="true" tabindex="-1"></a>16</span></code></pre></div>
<p>Denn <span class="math inline">\(2+2*4\neq4*4\)</span></p>
</div>
<div id="local-und-global-sind-getrennte-welten" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> <code>local</code> und <code>global</code> sind getrennte Welten<a href="macro.html#local-und-global-sind-getrennte-welten" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Geht, aber ist nicht zu empfehlen:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb13-1"><a href="macro.html#cb13-1" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">yx</span> = 1</span>
<span id="cb13-2"><a href="macro.html#cb13-2" aria-hidden="true" tabindex="-1"></a>loc <span class="kw">yx</span> = 2</span>
<span id="cb13-3"><a href="macro.html#cb13-3" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> <span class="kw">yx</span></span>
<span id="cb13-4"><a href="macro.html#cb13-4" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> _yx</span>
<span id="cb13-5"><a href="macro.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">yx</span>:             1</span>
<span id="cb13-6"><a href="macro.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="macro.html#cb13-7" aria-hidden="true" tabindex="-1"></a>_yx:            2</span></code></pre></div>
</div>
<div id="macros-mit-text" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Macros mit Text<a href="macro.html#macros-mit-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Wir können macros zu Texten zusammenbauen:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb14-1"><a href="macro.html#cb14-1" aria-hidden="true" tabindex="-1"></a>glo t1 <span class="st">&quot;Hallo&quot;</span></span>
<span id="cb14-2"><a href="macro.html#cb14-2" aria-hidden="true" tabindex="-1"></a>glo t2 <span class="st">&quot; zusammen&quot;</span></span>
<span id="cb14-3"><a href="macro.html#cb14-3" aria-hidden="true" tabindex="-1"></a>glo t3 <span class="st">&quot;! :-)&quot;</span></span>
<span id="cb14-4"><a href="macro.html#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="macro.html#cb14-5" aria-hidden="true" tabindex="-1"></a>glo t4 = <span class="st">&quot;${t1}${t2}${t3}&quot;</span></span>
<span id="cb14-6"><a href="macro.html#cb14-6" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;${t4}&quot;</span></span>
<span id="cb14-7"><a href="macro.html#cb14-7" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> t1 t2 t3 t4</span>
<span id="cb14-8"><a href="macro.html#cb14-8" aria-hidden="true" tabindex="-1"></a>Hallo zusammen! :-)</span>
<span id="cb14-9"><a href="macro.html#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="macro.html#cb14-10" aria-hidden="true" tabindex="-1"></a>t1:             Hallo</span>
<span id="cb14-11"><a href="macro.html#cb14-11" aria-hidden="true" tabindex="-1"></a>t2:              zusammen</span>
<span id="cb14-12"><a href="macro.html#cb14-12" aria-hidden="true" tabindex="-1"></a>t3:             ! :-)</span>
<span id="cb14-13"><a href="macro.html#cb14-13" aria-hidden="true" tabindex="-1"></a>t4:             Hallo zusammen! :-)</span></code></pre></div>
<hr />
<p><strong><a href="macro.html#ue0">Übung</a></strong></p>
<hr />
</div>
<div id="dateipfade" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Dateipfade<a href="macro.html#dateipfade" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ein macro kann auch Text enthalten und wir können diesen bspw. für Dateipfade macros verwenden:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb15-1"><a href="macro.html#cb15-1" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">&quot;D:\Projekt\daten\BIBB_BAuA&quot;</span> <span class="co">// wo liegt der Datensatz?</span></span>
<span id="cb15-2"><a href="macro.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;${pfad}/BIBBBAuA_2018_suf1.0.dta&quot;</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code></pre></div>
<p>Wir können das auch nutzen, um DoFiles in Kooperationsprojekten zu bauen, wenn verschiedenen Personen die DoFiles verwenden:
<img src="pics/01_pfade.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb16-1"><a href="macro.html#cb16-1" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">&quot;C:\Projekte\Micha&quot;</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb16-2"><a href="macro.html#cb16-2" aria-hidden="true" tabindex="-1"></a>glo pfad <span class="st">&quot;D:\Arbeit\Alex&quot;</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb16-3"><a href="macro.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="macro.html#cb16-4" aria-hidden="true" tabindex="-1"></a>glo prog <span class="st">&quot;${pfad}/prog&quot;</span>  </span>
<span id="cb16-5"><a href="macro.html#cb16-5" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">data</span> <span class="st">&quot;${pfad}/data&quot;</span></span>
<span id="cb16-6"><a href="macro.html#cb16-6" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">log</span>  <span class="st">&quot;${pfad}/log&quot;</span></span></code></pre></div>
<p>Micha würde dann immer den Pfad von Alex überspringen/auskommentieren und umgekehrt.
Wir lernen <a href="macro.html#if1">gleich</a> noch eine Möglichkeit kennen, das auch direkt mit zu lösen mit dem Usernamen der verwendeten PCs.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb17-1"><a href="macro.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;${data}/BIBBBAuA_2018_suf1.0.dta&quot;</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code></pre></div>
<p>Die <code>" "</code> sind nicht zwingend nötig in diesem Fall.
Sollten aber Leerzeichen im Pfad vorkommen, brauchen wir auf jeden Fall <code>" "</code>.
Außerdem ist <a href="macro.html#dir"><code>\</code> beim Zusammenbauen mit macros manchmal problematisch</a>) - auch hier helfen <code>" "</code>.
Alternativ hilft hier <code>/</code> statt <code>\</code> zu verwenden.</p>
<p>Mit <code>mkdir</code> können wir auch Ordner erstellen.
Wenn also noch kein log-Ordner existiert, können wir ihn so erstellen:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb18-1"><a href="macro.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mkdir</span> <span class="ot">${log}</span></span></code></pre></div>
<p>Mit <code>cap cd</code> können wir das vorher überprüfen:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb19-1"><a href="macro.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">capture</span> cd  <span class="st">&quot;${log}&quot;</span></span>
<span id="cb19-2"><a href="macro.html#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="dt">_rc</span>!=0  {</span>
<span id="cb19-3"><a href="macro.html#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">mkdir</span> <span class="ot">${log}</span></span>
<span id="cb19-4"><a href="macro.html#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">display</span> <span class="st">&quot;${log} erstellt&quot;</span></span>
<span id="cb19-5"><a href="macro.html#cb19-5" aria-hidden="true" tabindex="-1"></a>    } </span></code></pre></div>
<p><strong>Siehe <code>01_init_beispiel.do</code> für ein Beispiel für einige Befehle beim Erstellen eines Projektverzeichnisses.</strong></p>
</div>
<div id="cmac" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Bereits definierte Macros<a href="macro.html#cmac" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Mit <code>mac list</code> bekommen wir auch einige von Stata bereits vorgegebenen Macros angezeigt.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb20-1"><a href="macro.html#cb20-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span></span></code></pre></div>
<p>Zwei sehr nützliche sind dabei <code>$S_DATE</code> <code>$S_TIME</code> - das aktuelle Datum und die aktuelle Zeit:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb21-1"><a href="macro.html#cb21-1" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;$S_DATE&quot;</span></span>
<span id="cb21-2"><a href="macro.html#cb21-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;$S_TIME&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb22-1"><a href="macro.html#cb22-1" aria-hidden="true" tabindex="-1"></a>2 May 2022</span>
<span id="cb22-2"><a href="macro.html#cb22-2" aria-hidden="true" tabindex="-1"></a>12:44:22</span></code></pre></div>
<p>Diese können wir beispielsweise am Anfang und Ende eines Abschnitts in einem LogFiles einblenden, um Start- und Endzeit zu dokumentieren:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb23-1"><a href="macro.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">using</span> <span class="st">&quot;${log}/logfile.txt&quot;</span>, t <span class="kw">replace</span></span>
<span id="cb23-2"><a href="macro.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> ....</span>
<span id="cb23-3"><a href="macro.html#cb23-3" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;Start: $S_DATE um $S_TIME&quot;</span></span>
<span id="cb23-4"><a href="macro.html#cb23-4" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-5"><a href="macro.html#cb23-5" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-6"><a href="macro.html#cb23-6" aria-hidden="true" tabindex="-1"></a>Hier kommen aufwändige Modelle</span>
<span id="cb23-7"><a href="macro.html#cb23-7" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-8"><a href="macro.html#cb23-8" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-9"><a href="macro.html#cb23-9" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-10"><a href="macro.html#cb23-10" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;Ende: $S_DATE um $S_TIME&quot;</span></span>
<span id="cb23-11"><a href="macro.html#cb23-11" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-12"><a href="macro.html#cb23-12" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-13"><a href="macro.html#cb23-13" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb23-14"><a href="macro.html#cb23-14" aria-hidden="true" tabindex="-1"></a>cap <span class="fu">log</span> <span class="kw">close</span></span></code></pre></div>
<p>So können wir beispielsweise automatisch log-Files mit einem Datum versehen:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb24-1"><a href="macro.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> <span class="fu">date</span> = <span class="fu">string</span>( <span class="kw">d</span>(<span class="ot">$S_DATE</span>), <span class="st">&quot;%tdCY-N-D&quot;</span> )</span>
<span id="cb24-2"><a href="macro.html#cb24-2" aria-hidden="true" tabindex="-1"></a>* <span class="kw">help</span> datetime_display_formats <span class="co">// für andere Datumsformate</span></span>
<span id="cb24-3"><a href="macro.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="macro.html#cb24-4" aria-hidden="true" tabindex="-1"></a>cap <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb24-5"><a href="macro.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span> <span class="kw">using</span> <span class="st">&quot;${log}/01_macro_loops_${date}.log&quot;</span>, <span class="kw">replace</span> <span class="bn">text</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb25-1"><a href="macro.html#cb25-1" aria-hidden="true" tabindex="-1"></a>. <span class="fu">log</span> <span class="kw">using</span> <span class="st">&quot;${log}/01_macro_loops_${date}.log&quot;</span>, <span class="kw">replace</span> <span class="bn">text</span></span>
<span id="cb25-2"><a href="macro.html#cb25-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">note</span>: file D:\Arbeit\Alex/<span class="fu">log</span>/01_macro_loops_2021-12-01.<span class="fu">log</span> <span class="kw">not</span> found)</span>
<span id="cb25-3"><a href="macro.html#cb25-3" aria-hidden="true" tabindex="-1"></a>--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb25-4"><a href="macro.html#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="bn">name</span>:  &lt;unnamed&gt;</span>
<span id="cb25-5"><a href="macro.html#cb25-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">log</span>:  D:\Arbeit\Alex/<span class="fu">log</span>/01_macro_loops_2021-12-01.<span class="fu">log</span></span>
<span id="cb25-6"><a href="macro.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span> <span class="dv">type</span>:  <span class="bn">text</span></span>
<span id="cb25-7"><a href="macro.html#cb25-7" aria-hidden="true" tabindex="-1"></a> opened <span class="kw">on</span>:  01 Dec 2021, 10:45:04</span></code></pre></div>
<p>Außerdem gibt es einige <code>locals</code> mit nützlichen Infos:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb26-1"><a href="macro.html#cb26-1" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;`c(username)&#39;&quot;</span></span>
<span id="cb26-2"><a href="macro.html#cb26-2" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;`c(machine_type)&#39;&quot;</span></span>
<span id="cb26-3"><a href="macro.html#cb26-3" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;`c(os)&#39;&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb27-1"><a href="macro.html#cb27-1" aria-hidden="true" tabindex="-1"></a>Filser</span>
<span id="cb27-2"><a href="macro.html#cb27-2" aria-hidden="true" tabindex="-1"></a>PC (64-bit x86-64)</span>
<span id="cb27-3"><a href="macro.html#cb27-3" aria-hidden="true" tabindex="-1"></a>Windows</span></code></pre></div>
<p>Weitere “system parameters and settings” unter <code>help creturn</code> bspw.:</p>
<ul>
<li><code>c(changed)</code> returns a numeric scalar equal to 0 if the dataset in memory has not changed since it was last saved and 1 otherwise.</li>
<li><code>c(filename)</code> returns a string containing the filename last specified with a use or save, such as <code>"C:\Data\auto.dta"</code>.</li>
<li><code>c(filedate)</code> returns a string containing the date and time the file in <code>c(filename)</code> was last saved, such as “7 Jul 2016 13:51”.</li>
</ul>
<div id="if1" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> <code>if</code><a href="macro.html#if1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mit <code>if (</code>local<code>== "...")</code> können wir macros abgleichen, um Befehle nur unter bestimmten Bedingungen auszuführen:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb28-1"><a href="macro.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Filser&quot;</span>)  <span class="kw">display</span> <span class="st">&quot;Du bist Filser&quot;</span></span>
<span id="cb28-2"><a href="macro.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> != <span class="st">&quot;Fischer&quot;</span>) <span class="kw">display</span> <span class="st">&quot;Du bist nicht Fischer&quot;</span></span></code></pre></div>
<p>Das können wir für den Fall von eben mit mehreren Nutzern nutzen:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb29-1"><a href="macro.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Alex&quot;</span>)   glo pfad <span class="st">&quot;C:\Projekte\Micha&quot;</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb29-2"><a href="macro.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> (<span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Micha&quot;</span>)  glo pfad <span class="st">&quot;D:\Arbeit\Alex&quot;</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb29-3"><a href="macro.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="macro.html#cb29-4" aria-hidden="true" tabindex="-1"></a>glo prog <span class="st">&quot;${pfad}/prog&quot;</span>  </span>
<span id="cb29-5"><a href="macro.html#cb29-5" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">data</span> <span class="st">&quot;${pfad}/data&quot;</span></span>
<span id="cb29-6"><a href="macro.html#cb29-6" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">log</span>  <span class="st">&quot;${pfad}/log&quot;</span></span>
<span id="cb29-7"><a href="macro.html#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="macro.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">&quot;${pfad}/BIBBBAuA_2018_suf1.0.dta&quot;</span>, <span class="kw">clear</span> <span class="co">// laden des Datensatzes </span></span></code></pre></div>
<p>Für <code>if</code>-Bedingungen stehen uns die üblichen Operatoren zur Verfügung, die wir auch aus den <code>if</code>-Statements in Befehlen kennen:
<code>&gt;</code>, <code>&lt;</code>, <code>==</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>/<code>~=</code> (ungleich)
Mit <code>|</code> können wir <em>oder</em>-Bedingungen stellen.</p>
<ul>
<li><code>inrange</code>: einen Wertebereich auswählen</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb30-1"><a href="macro.html#cb30-1" aria-hidden="true" tabindex="-1"></a>loc x = 20</span>
<span id="cb30-2"><a href="macro.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`x&#39;</span> &gt;= 20 &amp; <span class="ot">`x&#39;</span> &lt;= 30 <span class="kw">display</span> <span class="st">&quot;&amp; yes&quot;</span>  </span>
<span id="cb30-3"><a href="macro.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inrange</span>(<span class="ot">`x&#39;</span>,20,30) <span class="kw">display</span> <span class="st">&quot;inrange yes&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb31-1"><a href="macro.html#cb31-1" aria-hidden="true" tabindex="-1"></a>loc x = 19</span>
<span id="cb31-2"><a href="macro.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inrange</span>(<span class="ot">`x&#39;</span>,20,30) <span class="kw">display</span> <span class="st">&quot;yes&quot;</span></span></code></pre></div>
<ul>
<li><code>inlist</code>: spezifische Werte angeben, um lange Folgen von <code>|</code> zu vermeiden:</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb32-1"><a href="macro.html#cb32-1" aria-hidden="true" tabindex="-1"></a>loc x = 20</span>
<span id="cb32-2"><a href="macro.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`x&#39;</span> == 18 | <span class="ot">`x&#39;</span> == 20 | <span class="ot">`x&#39;</span> == 22 | <span class="ot">`x&#39;</span> == 28 <span class="kw">display</span> <span class="st">&quot;| yes&quot;</span>  </span>
<span id="cb32-3"><a href="macro.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inlist</span>(<span class="ot">`x&#39;</span>,18,20,22,28) <span class="kw">display</span> <span class="st">&quot;inlist yes&quot;</span>  </span></code></pre></div>
</div>
<div id="macros-als-variablennamen-und-befehle" class="section level3 hasAnchor" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Macros als Variablennamen und Befehle<a href="macro.html#macros-als-variablennamen-und-befehle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Auch so etwas ist möglich:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb33-1"><a href="macro.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> n 200</span>
<span id="cb33-2"><a href="macro.html#cb33-2" aria-hidden="true" tabindex="-1"></a>su F<span class="ot">`n&#39;</span></span></code></pre></div>
<pre><code>    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        F200 |     17,953    36.24272    14.03048          1         99</code></pre>
<p>Ein macro kann auch ein Programm sein:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb35-1"><a href="macro.html#cb35-1" aria-hidden="true" tabindex="-1"></a>loc t <span class="kw">tab</span></span>
<span id="cb35-2"><a href="macro.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="ot">`t&#39;</span> mobil</span></code></pre></div>
<pre><code>Mobilfunkin |
    terview |      Freq.     Percent        Cum.
------------+-----------------------------------
   Festnetz |     14,008       70.00       70.00
  Mobilfunk |      6,004       30.00      100.00
------------+-----------------------------------
      Total |     20,012      100.00</code></pre>
<p><span class="math inline">\(\Rightarrow\)</span> sollen macros als Text verstanden werden, sind <code>""</code> nötig:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb37-1"><a href="macro.html#cb37-1" aria-hidden="true" tabindex="-1"></a>loc opt ja</span>
<span id="cb37-2"><a href="macro.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inlist</span>(<span class="ot">`opt&#39;</span>,<span class="st">&quot;ja&quot;</span>,<span class="st">&quot;JA&quot;</span>,<span class="st">&quot;Ja&quot;</span>,<span class="st">&quot;ok&quot;</span>) <span class="kw">tab</span> mobil</span>
<span id="cb37-3"><a href="macro.html#cb37-3" aria-hidden="true" tabindex="-1"></a>ja <span class="kw">not</span> found</span>
<span id="cb37-4"><a href="macro.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">r</span>(111);</span>
<span id="cb37-5"><a href="macro.html#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="macro.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> <span class="kw">of</span> <span class="kw">do</span>-file</span>
<span id="cb37-7"><a href="macro.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">r</span>(111);</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb38-1"><a href="macro.html#cb38-1" aria-hidden="true" tabindex="-1"></a>loc opt ja</span>
<span id="cb38-2"><a href="macro.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">inlist</span>(<span class="st">&quot;`opt&#39;&quot;</span>,<span class="st">&quot;ja&quot;</span>,<span class="st">&quot;JA&quot;</span>,<span class="st">&quot;Ja&quot;</span>,<span class="st">&quot;ok&quot;</span>) <span class="kw">tab</span> mobil</span></code></pre></div>
<pre><code>Mobilfunkin |
    terview |      Freq.     Percent        Cum.
------------+-----------------------------------
   Festnetz |     14,008       70.00       70.00
  Mobilfunk |      6,004       30.00      100.00
------------+-----------------------------------
      Total |     20,012      100.00</code></pre>
</div>
<div id="allglo" class="section level3 hasAnchor" number="1.5.3">
<h3><span class="header-section-number">1.5.3</span> <code>globals</code> durchsuchen<a href="macro.html#allglo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mit Hilfe sog. Wildcards können wir Zeichen “offen lassen”:</p>
<ul>
<li><code>?</code> ersetzt ein Zeichen</li>
<li><code>*</code> mehrere oder keines</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb40-1"><a href="macro.html#cb40-1" aria-hidden="true" tabindex="-1"></a>glo x1 = 2</span>
<span id="cb40-2"><a href="macro.html#cb40-2" aria-hidden="true" tabindex="-1"></a>glo <span class="kw">x2</span> <span class="st">&quot;das ist x2&quot;</span></span>
<span id="cb40-3"><a href="macro.html#cb40-3" aria-hidden="true" tabindex="-1"></a>glo x 291</span>
<span id="cb40-4"><a href="macro.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> allglo:  <span class="ot">all</span> globals <span class="st">&quot;x*&quot;</span></span>
<span id="cb40-5"><a href="macro.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> allglo2: <span class="ot">all</span> globals <span class="st">&quot;x?&quot;</span></span>
<span id="cb40-6"><a href="macro.html#cb40-6" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">l</span> allglo2 allglo</span>
<span id="cb40-7"><a href="macro.html#cb40-7" aria-hidden="true" tabindex="-1"></a>allglo2:        <span class="kw">x2</span> x1</span>
<span id="cb40-8"><a href="macro.html#cb40-8" aria-hidden="true" tabindex="-1"></a>allglo:         x <span class="kw">x2</span> x1</span></code></pre></div>
<p>Hier haben wir auch schon die dritte Form der macro Definition kennengelernt, die sog. <code>extended macro function</code>, welche auf <code>:</code> folgt. Hier also <code>all globals</code>, im Laufe dieses Kurses werden wir noch zahlreiche dieser Funktionen kennenlernen.</p>
</div>
</div>
<div id="wenn-nicht-if-dann-else" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Wenn nicht <code>if</code>, dann <code>else</code><a href="macro.html#wenn-nicht-if-dann-else" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Mit <code>if</code> haben wir die Möglichkeiten aber noch nicht ausgeschöpft - aus <code>help if</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb41-1"><a href="macro.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ot">`n&#39;</span>==1 {</span>
<span id="cb41-2"><a href="macro.html#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;one&quot;</span></span>
<span id="cb41-3"><a href="macro.html#cb41-3" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb41-4"><a href="macro.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="ot">`n&#39;</span>==2 {</span>
<span id="cb41-5"><a href="macro.html#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;two&quot;</span></span>
<span id="cb41-6"><a href="macro.html#cb41-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-7"><a href="macro.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="ot">`n&#39;</span>==3 {</span>
<span id="cb41-8"><a href="macro.html#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;three&quot;</span></span>
<span id="cb41-9"><a href="macro.html#cb41-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-10"><a href="macro.html#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> {</span>
<span id="cb41-11"><a href="macro.html#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="fu">word</span> <span class="st">&quot;big&quot;</span></span>
<span id="cb41-12"><a href="macro.html#cb41-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-13"><a href="macro.html#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">&quot;`word&#39;&quot;</span></span></code></pre></div>
</div>
<div id="unterbrechen-wenn-ein-fehler-vorliegt" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Unterbrechen wenn ein Fehler vorliegt<a href="macro.html#unterbrechen-wenn-ein-fehler-vorliegt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Mit <code>exit</code> (<code>help exit_program</code>) können wir Stata zu einer Unterbrechung bringen:</p>
<blockquote>
<p><code>exit</code> causes Stata to terminate the current process and returns control to the calling process.</p>
</blockquote>
<div class="sourceCode" id="cb42"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb42-1"><a href="macro.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Alex&quot;</span> {</span>
<span id="cb42-2"><a href="macro.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  glo pfad <span class="st">&quot;C:\Projekte\Micha&quot;</span> <span class="co">// wo liegt der Datensatz bei Alex?</span></span>
<span id="cb42-3"><a href="macro.html#cb42-3" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb42-4"><a href="macro.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> <span class="kw">if</span> <span class="st">&quot;`c(username)&#39;&quot;</span> == <span class="st">&quot;Micha&quot;</span> {</span>
<span id="cb42-5"><a href="macro.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  glo pfad <span class="st">&quot;D:\Arbeit\Alex&quot;</span>    <span class="co">// wo liegt der Datensatz bei Micha?</span></span>
<span id="cb42-6"><a href="macro.html#cb42-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-7"><a href="macro.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span> {</span>
<span id="cb42-8"><a href="macro.html#cb42-8" aria-hidden="true" tabindex="-1"></a> <span class="kw">display</span> <span class="kw">as</span> <span class="kw">error</span> <span class="st">&quot;Hier fehlt der passende Pfad&quot;</span></span>
<span id="cb42-9"><a href="macro.html#cb42-9" aria-hidden="true" tabindex="-1"></a> <span class="kw">exit</span> </span>
<span id="cb42-10"><a href="macro.html#cb42-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-11"><a href="macro.html#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> mobil</span>
<span id="cb42-12"><a href="macro.html#cb42-12" aria-hidden="true" tabindex="-1"></a>Hier fehlt der passende Pfad</span>
<span id="cb42-13"><a href="macro.html#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="macro.html#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> <span class="kw">of</span> <span class="kw">do</span>-file</span></code></pre></div>
<hr />
<p><strong><a href="macro.html#ue1">Übung</a></strong></p>
<hr />
</div>
<div id="schleifen-foreach-forvalues" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> Schleifen: <code>foreach</code> &amp; <code>forvalues</code><a href="macro.html#schleifen-foreach-forvalues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Schleifen helfen uns das DRY (“Don’t repeat yourself”) Prinzip umzusetzen.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb43-1"><a href="macro.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= 19</span>
<span id="cb43-2"><a href="macro.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= 24</span>
<span id="cb43-3"><a href="macro.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= 29</span>
<span id="cb43-4"><a href="macro.html#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="macro.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)29 {</span>
<span id="cb43-6"><a href="macro.html#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;Alter bis `v&#39;&quot;</span></span>
<span id="cb43-7"><a href="macro.html#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= <span class="ot">`v&#39;</span></span>
<span id="cb43-8"><a href="macro.html#cb43-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Ein vereinfachtes Syntaxdiagramm der <code>foreach</code>-Schleife sieht so aus:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb44-1"><a href="macro.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> listtype <span class="ot">list</span> {</span>
<span id="cb44-2"><a href="macro.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  Befehle</span>
<span id="cb44-3"><a href="macro.html#cb44-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>lname</code> steht dabei für ein <code>local</code> macro.</p>
<p>Wir können unterschiedliche Typen von <code>foreach</code>-Listen verwenden:</p>
<p>– <code>of varlist</code>: Variablenlisten<br />
– <code>of newlist</code>: neue Variablen<br />
– <code>of numlist</code>: Nummernlisten - bspw. <code>(0(1)5)</code> <span class="math inline">\(\Rightarrow\)</span> “1 bis 5 in Schritten von 1” <a href="https://www.stata.com/manuals13/pnumlist.pdf">weitere Varianten</a><br />
– <code>in</code>: beliebige Listen von Buchstaben, Zahlen oder Wörtern (durch Leerzeichen getrennt)</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb45-1"><a href="macro.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">in</span> any_list {</span>
<span id="cb45-2"><a href="macro.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> <span class="kw">local</span>    <span class="kw">local</span>      {</span>
<span id="cb45-3"><a href="macro.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> <span class="kw">global</span>   <span class="kw">global</span>     {</span>
<span id="cb45-4"><a href="macro.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> <span class="kw">varlist</span>  variablen  { <span class="co">//auch Wildcards möglich - analog zu d F2**</span></span>
<span id="cb45-5"><a href="macro.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> newlist  newvarlist { <span class="co">//wenn variablen erst generiert werden</span></span>
<span id="cb45-6"><a href="macro.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="fu">lname</span> <span class="kw">of</span> numlist  numlist    {</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb46-1"><a href="macro.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 1/3 6(1)9  {</span>
<span id="cb46-2"><a href="macro.html#cb46-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;`n&#39;&quot;</span></span>
<span id="cb46-3"><a href="macro.html#cb46-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-4"><a href="macro.html#cb46-4" aria-hidden="true" tabindex="-1"></a>1</span>
<span id="cb46-5"><a href="macro.html#cb46-5" aria-hidden="true" tabindex="-1"></a>2</span>
<span id="cb46-6"><a href="macro.html#cb46-6" aria-hidden="true" tabindex="-1"></a>3</span>
<span id="cb46-7"><a href="macro.html#cb46-7" aria-hidden="true" tabindex="-1"></a>6</span>
<span id="cb46-8"><a href="macro.html#cb46-8" aria-hidden="true" tabindex="-1"></a>7</span>
<span id="cb46-9"><a href="macro.html#cb46-9" aria-hidden="true" tabindex="-1"></a>8</span>
<span id="cb46-10"><a href="macro.html#cb46-10" aria-hidden="true" tabindex="-1"></a>9</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb47-1"><a href="macro.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 6 4: -4  {</span>
<span id="cb47-2"><a href="macro.html#cb47-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;`n&#39;&quot;</span></span>
<span id="cb47-3"><a href="macro.html#cb47-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-4"><a href="macro.html#cb47-4" aria-hidden="true" tabindex="-1"></a>6</span>
<span id="cb47-5"><a href="macro.html#cb47-5" aria-hidden="true" tabindex="-1"></a>4</span>
<span id="cb47-6"><a href="macro.html#cb47-6" aria-hidden="true" tabindex="-1"></a>2</span>
<span id="cb47-7"><a href="macro.html#cb47-7" aria-hidden="true" tabindex="-1"></a>0</span>
<span id="cb47-8"><a href="macro.html#cb47-8" aria-hidden="true" tabindex="-1"></a>-2</span>
<span id="cb47-9"><a href="macro.html#cb47-9" aria-hidden="true" tabindex="-1"></a>-4</span></code></pre></div>
<div id="ferest" class="section level3 hasAnchor" number="1.8.1">
<h3><span class="header-section-number">1.8.1</span> <code>ferest()</code><a href="macro.html#ferest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mit <code>ferest()</code> können wir uns die “noch übrigen Werte in der Liste anzeigen lassen:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb48-1"><a href="macro.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> n <span class="kw">of</span> numlist 1(1)5 {</span>
<span id="cb48-2"><a href="macro.html#cb48-2" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;`n&#39;&quot;</span></span>
<span id="cb48-3"><a href="macro.html#cb48-3" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;Es kommen noch: `ferest()&#39;&quot;</span></span>
<span id="cb48-4"><a href="macro.html#cb48-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5"><a href="macro.html#cb48-5" aria-hidden="true" tabindex="-1"></a>1</span>
<span id="cb48-6"><a href="macro.html#cb48-6" aria-hidden="true" tabindex="-1"></a>Es kommen noch: 2 3 4 5</span>
<span id="cb48-7"><a href="macro.html#cb48-7" aria-hidden="true" tabindex="-1"></a>2</span>
<span id="cb48-8"><a href="macro.html#cb48-8" aria-hidden="true" tabindex="-1"></a>Es kommen noch: 3 4 5</span>
<span id="cb48-9"><a href="macro.html#cb48-9" aria-hidden="true" tabindex="-1"></a>3</span>
<span id="cb48-10"><a href="macro.html#cb48-10" aria-hidden="true" tabindex="-1"></a>Es kommen noch: 4 5</span>
<span id="cb48-11"><a href="macro.html#cb48-11" aria-hidden="true" tabindex="-1"></a>4</span>
<span id="cb48-12"><a href="macro.html#cb48-12" aria-hidden="true" tabindex="-1"></a>Es kommen noch: 5</span>
<span id="cb48-13"><a href="macro.html#cb48-13" aria-hidden="true" tabindex="-1"></a>5</span>
<span id="cb48-14"><a href="macro.html#cb48-14" aria-hidden="true" tabindex="-1"></a>Es kommen noch: </span></code></pre></div>
</div>
<div id="weitere-schleifentypen" class="section level3 hasAnchor" number="1.8.2">
<h3><span class="header-section-number">1.8.2</span> Weitere Schleifentypen<a href="macro.html#weitere-schleifentypen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es gibt außerdem <code>forvalues</code>:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb49-1"><a href="macro.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">lname</span>=<span class="kw">range</span> {</span>
<span id="cb49-2"><a href="macro.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  Befehle</span>
<span id="cb49-3"><a href="macro.html#cb49-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>forvalues</code>-Schleife ist eine <code>foreach</code>-Schleife mit <code>numlist</code>.
Aber: Die <code>foreach</code>-Schleife mit einer <code>numlist</code> funktioniert nicht mit einer beliebig hohen Anzahl von Ziffern.
In der <code>forvalues</code>-Schleife gibt es keine Beschränkung. Außerdem ist <code>forvalues</code>-Schleife schneller im Abarbeiten von Nummernlisten.</p>
<p>Und dann gibt es noch die <code>while</code>-Schleife:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb50-1"><a href="macro.html#cb50-1" aria-hidden="true" tabindex="-1"></a>loc i = 1</span>
<span id="cb50-2"><a href="macro.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ot">`i&#39;</span> &lt;= 5 {</span>
<span id="cb50-3"><a href="macro.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span> <span class="st">&quot;`i&#39;&quot;</span></span>
<span id="cb50-4"><a href="macro.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  loc i = <span class="ot">`i&#39;</span> + 1</span>
<span id="cb50-5"><a href="macro.html#cb50-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-6"><a href="macro.html#cb50-6" aria-hidden="true" tabindex="-1"></a>1</span>
<span id="cb50-7"><a href="macro.html#cb50-7" aria-hidden="true" tabindex="-1"></a>2</span>
<span id="cb50-8"><a href="macro.html#cb50-8" aria-hidden="true" tabindex="-1"></a>3</span>
<span id="cb50-9"><a href="macro.html#cb50-9" aria-hidden="true" tabindex="-1"></a>4</span>
<span id="cb50-10"><a href="macro.html#cb50-10" aria-hidden="true" tabindex="-1"></a>5</span></code></pre></div>
<p>Eine Besonderheit bei <code>local</code>s ist, dass wir mit <code>loc ++i</code> den Wert um 1 erhöhen können. Somit führt folgende Syntax zum gleichen Ergebnis:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb51-1"><a href="macro.html#cb51-1" aria-hidden="true" tabindex="-1"></a>loc i = 1</span>
<span id="cb51-2"><a href="macro.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ot">`i&#39;</span> &lt;= 5 {</span>
<span id="cb51-3"><a href="macro.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">display</span> <span class="st">&quot;`i&#39;&quot;</span></span>
<span id="cb51-4"><a href="macro.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  loc ++i</span>
<span id="cb51-5"><a href="macro.html#cb51-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="anwendung" class="section level3 hasAnchor" number="1.8.3">
<h3><span class="header-section-number">1.8.3</span> Anwendung<a href="macro.html#anwendung" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb52-1"><a href="macro.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb52-2"><a href="macro.html#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;Alter bis `v&#39;&quot;</span></span>
<span id="cb52-3"><a href="macro.html#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> zpalter &lt;= <span class="ot">`v&#39;</span></span>
<span id="cb52-4"><a href="macro.html#cb52-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Alter bis 19

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |         41       67.21       67.21
   weiblich |         20       32.79      100.00
------------+-----------------------------------
      Total |         61      100.00
Alter bis 24

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        373       65.10       65.10
   weiblich |        200       34.90      100.00
------------+-----------------------------------
      Total |        573      100.00
Alter bis 29

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        991       60.46       60.46
   weiblich |        648       39.54      100.00
------------+-----------------------------------
      Total |      1,639      100.00
Alter bis 34

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |      1,984       59.03       59.03
   weiblich |      1,377       40.97      100.00
------------+-----------------------------------
      Total |      3,361      100.00</code></pre>
<p>…oder mit <code>inrange()</code>, um lediglich die 5-Jahresaltersgruppe anzuzeigen:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb54-1"><a href="macro.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb54-2"><a href="macro.html#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;Alter &quot;</span> <span class="ot">`v&#39;</span> - 4 <span class="st">&quot; bis &quot;</span> <span class="ot">`v&#39;</span></span>
<span id="cb54-3"><a href="macro.html#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab</span> S1 <span class="kw">if</span> <span class="fu">inrange</span>(zpalter,<span class="ot">`v&#39;</span>-4, <span class="ot">`v&#39;</span>)</span>
<span id="cb54-4"><a href="macro.html#cb54-4" aria-hidden="true" tabindex="-1"></a>    *su zpalter <span class="kw">if</span> <span class="fu">inrange</span>(zpalter,<span class="ot">`v&#39;</span>-4, <span class="ot">`v&#39;</span>)</span>
<span id="cb54-5"><a href="macro.html#cb54-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Alter 15 bis 19

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |         41       67.21       67.21
   weiblich |         20       32.79      100.00
------------+-----------------------------------
      Total |         61      100.00
Alter 20 bis 24

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        332       64.84       64.84
   weiblich |        180       35.16      100.00
------------+-----------------------------------
      Total |        512      100.00
Alter 25 bis 29

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        618       57.97       57.97
   weiblich |        448       42.03      100.00
------------+-----------------------------------
      Total |      1,066      100.00
Alter 30 bis 34

 Geschlecht |      Freq.     Percent        Cum.
------------+-----------------------------------
   männlich |        993       57.67       57.67
   weiblich |        729       42.33      100.00
------------+-----------------------------------
      Total |      1,722      100.00</code></pre>
</div>
<div id="schleifen-aufbauen" class="section level3 hasAnchor" number="1.8.4">
<h3><span class="header-section-number">1.8.4</span> Schleifen aufbauen<a href="macro.html#schleifen-aufbauen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Einfache Schleife mit <code>if</code>/<code>else</code>: ist Zahl gerade oder ungerade?</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb56-1"><a href="macro.html#cb56-1" aria-hidden="true" tabindex="-1"></a>loc n = 5</span>
<span id="cb56-2"><a href="macro.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">trunc</span>(<span class="ot">`n&#39;</span>/2) == <span class="ot">`n&#39;</span>/2 <span class="kw">display</span> <span class="st">&quot;ja&quot;</span></span>
<span id="cb56-3"><a href="macro.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">trunc</span>(<span class="ot">`n&#39;</span>/2) != <span class="ot">`n&#39;</span>/2 <span class="kw">display</span> <span class="st">&quot;nein&quot;</span></span>
<span id="cb56-4"><a href="macro.html#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="macro.html#cb56-5" aria-hidden="true" tabindex="-1"></a>loc n = 5</span>
<span id="cb56-6"><a href="macro.html#cb56-6" aria-hidden="true" tabindex="-1"></a>dis <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2) </span>
<span id="cb56-7"><a href="macro.html#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="macro.html#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="macro.html#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n = 1/10 {</span>
<span id="cb56-10"><a href="macro.html#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  == 0 dis <span class="st">&quot;`n&#39; ist gerade&quot;</span></span>
<span id="cb56-11"><a href="macro.html#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  &gt;  0  dis <span class="st">&quot;`n&#39; ist ungerade&quot;</span></span>
<span id="cb56-12"><a href="macro.html#cb56-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-13"><a href="macro.html#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="macro.html#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n = 1/10 {</span>
<span id="cb56-15"><a href="macro.html#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span>  <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  == 0 {</span>
<span id="cb56-16"><a href="macro.html#cb56-16" aria-hidden="true" tabindex="-1"></a>        dis <span class="st">&quot;`n&#39; ist gerade&quot;</span></span>
<span id="cb56-17"><a href="macro.html#cb56-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-18"><a href="macro.html#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> <span class="kw">if</span> <span class="fu">mod</span>(<span class="ot">`n&#39;</span>,2)  &gt; 0 {</span>
<span id="cb56-19"><a href="macro.html#cb56-19" aria-hidden="true" tabindex="-1"></a>        dis <span class="st">&quot;`n&#39; ist ungerade&quot;</span></span>
<span id="cb56-20"><a href="macro.html#cb56-20" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb56-21"><a href="macro.html#cb56-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><a href="https://de.wikipedia.org/wiki/Division_mit_Rest#Modulo">mod() ist der Modulo-Operator in Stata - es wird der “Rest” berechnet</a></p>
</div>
<div id="nested-loop" class="section level3 hasAnchor" number="1.8.5">
<h3><span class="header-section-number">1.8.5</span> nested loop<a href="macro.html#nested-loop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb57-1"><a href="macro.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> n1 = 1/3 {</span>
<span id="cb57-2"><a href="macro.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">forvalues</span> n2 = 1/3 {</span>
<span id="cb57-3"><a href="macro.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    dis <span class="st">&quot;n1 ist `n1&#39; und n2 ist `n2&#39; &quot;</span></span>
<span id="cb57-4"><a href="macro.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-5"><a href="macro.html#cb57-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-6"><a href="macro.html#cb57-6" aria-hidden="true" tabindex="-1"></a>n1 ist 1 und n2 ist 1 </span>
<span id="cb57-7"><a href="macro.html#cb57-7" aria-hidden="true" tabindex="-1"></a>n1 ist 1 und n2 ist 2 </span>
<span id="cb57-8"><a href="macro.html#cb57-8" aria-hidden="true" tabindex="-1"></a>n1 ist 1 und n2 ist 3 </span>
<span id="cb57-9"><a href="macro.html#cb57-9" aria-hidden="true" tabindex="-1"></a>n1 ist 2 und n2 ist 1 </span>
<span id="cb57-10"><a href="macro.html#cb57-10" aria-hidden="true" tabindex="-1"></a>n1 ist 2 und n2 ist 2 </span>
<span id="cb57-11"><a href="macro.html#cb57-11" aria-hidden="true" tabindex="-1"></a>n1 ist 2 und n2 ist 3 </span>
<span id="cb57-12"><a href="macro.html#cb57-12" aria-hidden="true" tabindex="-1"></a>n1 ist 3 und n2 ist 1 </span>
<span id="cb57-13"><a href="macro.html#cb57-13" aria-hidden="true" tabindex="-1"></a>n1 ist 3 und n2 ist 2 </span>
<span id="cb57-14"><a href="macro.html#cb57-14" aria-hidden="true" tabindex="-1"></a>n1 ist 3 und n2 ist 3 </span></code></pre></div>
</div>
<div id="display-vs.-macro-list" class="section level3 hasAnchor" number="1.8.6">
<h3><span class="header-section-number">1.8.6</span> <code>display</code> vs. <code>macro list</code><a href="macro.html#display-vs.-macro-list" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>macro list</code> stoppt das DoFile wenn der macro nicht existiert, <code>display</code> zeigt nur ein leeres Feld an:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb58-1"><a href="macro.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> labormarket LABOUR</span>
<span id="cb58-2"><a href="macro.html#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="macro.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">&quot;${labormarket}&quot;</span></span>
<span id="cb58-4"><a href="macro.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="kw">display</span> <span class="st">&quot;${labourmarket}&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb59-1"><a href="macro.html#cb59-1" aria-hidden="true" tabindex="-1"></a>LABOUR</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb60-1"><a href="macro.html#cb60-1" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> labormarket</span>
<span id="cb60-2"><a href="macro.html#cb60-2" aria-hidden="true" tabindex="-1"></a>mac <span class="ot">list</span> labourmarket</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb61-1"><a href="macro.html#cb61-1" aria-hidden="true" tabindex="-1"></a>labormarket:    LABOUR</span>
<span id="cb61-2"><a href="macro.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="macro.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> <span class="kw">macro</span> <span class="ot">$labourmarket</span> <span class="kw">not</span> found</span>
<span id="cb61-4"><a href="macro.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">r</span>(111);</span></code></pre></div>
<hr />
<p><strong><a href="macro.html#ue2">Übung</a></strong></p>
<hr />
<!-- - Variablen & value labels anzeigen/bearbeiten  -->
<!-- - Creating interaction variables -->
<!-- - Fitting models with alternative measures of education -->
<!-- - Recoding multiple variables the same way -->
<!-- - Creating a macro that holds accumulated information -->
<!-- - Retrieving information returned by Stata -->
</div>
</div>
<div id="übungen" class="section level2 hasAnchor" number="1.9">
<h2><span class="header-section-number">1.9</span> Übungen<a href="macro.html#übungen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ue0" class="section level3 hasAnchor" number="1.9.1">
<h3><span class="header-section-number">1.9.1</span> Übung<a href="macro.html#ue0" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Was ist das Ergebnis dieser Rechnung? Nehmen Sie sich einen Moment Zeit und rechnen Sie im Kopf - Überprüfen Sie dann ihr Ergebnis.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb62-1"><a href="macro.html#cb62-1" aria-hidden="true" tabindex="-1"></a>loc x = 4</span>
<span id="cb62-2"><a href="macro.html#cb62-2" aria-hidden="true" tabindex="-1"></a>glo <span class="fu">y</span> = 1+5</span>
<span id="cb62-3"><a href="macro.html#cb62-3" aria-hidden="true" tabindex="-1"></a>loc <span class="fu">y</span> 1+5</span>
<span id="cb62-4"><a href="macro.html#cb62-4" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">`x&#39;</span> * <span class="ot">`y&#39;</span></span></code></pre></div>
<ul>
<li>Wie können Sie hier aus <code>Hallo zusammen! :-)</code> folgende Ausgabe machen: <code>Hallo, zusammen! :-)</code> ohne die macros zu verändern oder einen neuen anzulegen?</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb63-1"><a href="macro.html#cb63-1" aria-hidden="true" tabindex="-1"></a>glo t1 <span class="st">&quot;Hallo&quot;</span></span>
<span id="cb63-2"><a href="macro.html#cb63-2" aria-hidden="true" tabindex="-1"></a>glo t2 <span class="st">&quot; zusammen&quot;</span></span>
<span id="cb63-3"><a href="macro.html#cb63-3" aria-hidden="true" tabindex="-1"></a>glo t3 <span class="st">&quot;! :-)&quot;</span></span>
<span id="cb63-4"><a href="macro.html#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="macro.html#cb63-5" aria-hidden="true" tabindex="-1"></a>glo t4 = <span class="st">&quot;${t1}${t2}${t3}&quot;</span></span>
<span id="cb63-6"><a href="macro.html#cb63-6" aria-hidden="true" tabindex="-1"></a>dis <span class="st">&quot;${t4}&quot;</span></span></code></pre></div>
</div>
<div id="ue1" class="section level3 hasAnchor" number="1.9.2">
<h3><span class="header-section-number">1.9.2</span> Übung<a href="macro.html#ue1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Pfad zusammenbauen für <code>use</code>: Erstellen Sie den Pfad für den <code>use</code>-Befehl schrittweise und unter Berücksichtigung Ihres Usernamens.
<ul>
<li>ggf. Dateiverzeichnis einrichten mit Ordner <em>log</em>, <em>prog</em> und <em>data</em> (gerne auch mehr oder andere Namen)</li>
<li>Legen Sie die Erwerbstätigenbefragung 2018 in den <em>data</em>-Ordner (oder dessen Äquivalent)</li>
<li>Wie ist der Username auf Ihrem Gerät?</li>
<li>Verwenden Sie ein <code>if</code>-Statement, um den Dateipfad zu erstellen</li>
<li>Erstellen Sie ein LogFile, welches das heutige Datum im Namen trägt.</li>
</ul></li>
<li>Lassen Sie sich alle <code>globals</code>, die mit “S” beginnen, in ein <code>gobal allS</code> ablegen. Was wurde alles gefunden?
<ul>
<li>Denken Sie an die <code>extended macro function</code> <a href="macro.html#allglo"><code>all globals</code></a></li>
<li>Wie könnten Sie eine Schleife bauen, die nacheinander alle <code>globals</code> anzeigt, die mit “S” beginnen?</li>
</ul></li>
</ul>
</div>
<div id="ue2" class="section level3 hasAnchor" number="1.9.3">
<h3><span class="header-section-number">1.9.3</span> FizzBuzz-Challenge<a href="macro.html#ue2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fizz Buzz wird/wurde als ein Screening-Instrument für Programmierer*innen verwendet. Fizz Buzz ist ein Kinderlernspiel, bei dem die Kinder üblicherweise im Kreis sitzen und reihum laut von eins aufwärts zählen. Allerdings gibt es drei Regeln:</p>
<ul>
<li>Alle Zahlen, die durch drei teilbar sind, müssen durch das Wort “Fizz” ersetzt werden</li>
<li>Alle Zahlen, die durch fünf teilbar sind, müssen durch das Wort “Buzz” ersetzt werden</li>
<li>Wenn eine Zahl durch drei und fünf teilbar ist, dann wird “Fizz Buzz” gerufen.</li>
</ul>
<p>Wie würden Sie mit <code>if</code> &amp; <code>else</code> eine Schleife bauen, welche diese Regeln umsetzt.
Was wäre der erste Schritt?
Bauen Sie dann die Schleife und lassen Sie die Schleife für den Wertebereich 0-30 laufen.</p>
</div>
<div id="ue3" class="section level3 hasAnchor" number="1.9.4">
<h3><span class="header-section-number">1.9.4</span> Übung<a href="macro.html#ue3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Passen Sie die Schleife mit <a href="macro.html#ferest"><code>ferest()</code></a> an, sodass hier im 5. Durchlauf nicht mehr <code>Es kommen noch:</code> steht, sondern <code>Fertig</code>.</p>
</div>
</div>
<div id="anhang" class="section level2 hasAnchor" number="1.10">
<h2><span class="header-section-number">1.10</span> Anhang<a href="macro.html#anhang" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dir" class="section level3 hasAnchor" number="1.10.1">
<h3><span class="header-section-number">1.10.1</span> Windows Dateipfade mit macros<a href="macro.html#dir" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.stata.com/manuals/u18.pdf#u18.3.11">Aus der Stata-Doku zu macros</a>:</p>
<p>Stata uses the  character to tell its parser not to expand macros.
Windows uses the  character as the directory path separator.
Mostly, there is no problem using a  in a filename. However, if you are writing a program that contains a Windows path in macro path and a filename in fname, do not assemble the final result as <code>‘path’\‘fname’</code> because Stata will interpret the  as an instruction to not expand <code>‘fname’</code>.
<span class="math inline">\(\Rightarrow\)</span> Instead, assemble the final result as <code>‘path’/‘fname’</code>.
Stata understands <code>/</code> as a directory separator on all platforms.</p>
</div>
<div id="debugging-wo-ist-der-wurm-drin" class="section level3 hasAnchor" number="1.10.2">
<h3><span class="header-section-number">1.10.2</span> Debugging: Wo ist der Wurm drin?<a href="macro.html#debugging-wo-ist-der-wurm-drin" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fehlersuch in langen <code>foreach</code>-Schleifen kann mühsam und nervig sein.
in many cases you would like to go throuh the code step by step then, however, the value of the loop index (which is a <code>local</code>)
In vielen Fällen möchte man den Code Schritt für Schritt durchgehen, dann aber den Wert des Schleifen-<code>locals</code> ist natürlich nach Abbruch der Schleife nicht mehr da.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb64-1"><a href="macro.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">y</span> = 1982/1985 {</span>
<span id="cb64-2"><a href="macro.html#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="st">&quot;${data}/wages-year`y&#39;&quot;</span>, <span class="kw">clear</span></span>
<span id="cb64-3"><a href="macro.html#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">capture</span> <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb64-4"><a href="macro.html#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span> <span class="kw">using</span> <span class="st">&quot;${data}/log`y&#39;.log&quot;</span>, <span class="bn">text</span> <span class="kw">replace</span></span>
<span id="cb64-5"><a href="macro.html#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">regress</span> lwage exper expersq educ</span>
<span id="cb64-6"><a href="macro.html#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">avplots</span></span>
<span id="cb64-7"><a href="macro.html#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">graph</span> <span class="kw">export</span> <span class="st">&quot;${graph}/avplots`y&#39;.png&quot;</span>, <span class="kw">replace</span></span>
<span id="cb64-8"><a href="macro.html#cb64-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Manchmal hilft ein einfacher Workaround: ein <code>global</code> aus dem <code>local</code> definieren:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb65-1"><a href="macro.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="fu">y</span> = 1982/1985 {</span>
<span id="cb65-2"><a href="macro.html#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> Y = <span class="ot">`y&#39;</span></span>
<span id="cb65-3"><a href="macro.html#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="st">&quot;${data}/wages-year`y&#39;&quot;</span>, <span class="kw">clear</span></span>
<span id="cb65-4"><a href="macro.html#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">capture</span> <span class="fu">log</span> <span class="kw">close</span></span>
<span id="cb65-5"><a href="macro.html#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span> <span class="kw">using</span> <span class="st">&quot;${data}/log`y&#39;.log&quot;</span>, <span class="bn">text</span> <span class="kw">replace</span></span>
<span id="cb65-6"><a href="macro.html#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">regress</span> lwage exper expersq educ</span>
<span id="cb65-7"><a href="macro.html#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">avplots</span></span>
<span id="cb65-8"><a href="macro.html#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">graph</span> <span class="kw">export</span> <span class="st">&quot;${graph}/avplots`y&#39;.png&quot;</span>, <span class="kw">replace</span></span>
<span id="cb65-9"><a href="macro.html#cb65-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Alternativ hilft häufig auch <code>set trace on</code> weiter. Hier werden immer die zuerst die macros und dann die eingesetzten Werte angezeigt:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb66-1"><a href="macro.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="fu">trace</span> <span class="kw">on</span></span>
<span id="cb66-2"><a href="macro.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> v <span class="kw">of</span> numlist 19(5)35 {</span>
<span id="cb66-3"><a href="macro.html#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span> <span class="st">&quot;Alter &quot;</span> <span class="ot">`v&#39;</span> - 4 <span class="st">&quot; bis &quot;</span> <span class="ot">`v&#39;</span></span>
<span id="cb66-4"><a href="macro.html#cb66-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>- foreach v of numlist 19(5)35 {
- display &quot;Alter &quot; `v&#39; - 4 &quot; bis &quot; `v&#39;
= display &quot;Alter &quot; 19 - 4 &quot; bis &quot; 19
Alter 15 bis 19
- }
- display &quot;Alter &quot; `v&#39; - 4 &quot; bis &quot; `v&#39;
= display &quot;Alter &quot; 24 - 4 &quot; bis &quot; 24
Alter 20 bis 24
- }
- display &quot;Alter &quot; `v&#39; - 4 &quot; bis &quot; `v&#39;
= display &quot;Alter &quot; 29 - 4 &quot; bis &quot; 29
Alter 25 bis 29
- }
- display &quot;Alter &quot; `v&#39; - 4 &quot; bis &quot; `v&#39;
= display &quot;Alter &quot; 34 - 4 &quot; bis &quot; 34
Alter 30 bis 34
- }</code></pre>
<!-- ### `local x` entspricht `global _x` -->
<!-- Theoretisch kann man auch mit `global _x` einen `local x` erzeugen: -->
<!-- ```{stata det0a, eval= F} -->
<!-- local   x = 2 -->
<!-- global _x = 3 -->
<!-- dis  -->
<!-- ``` -->
<!-- ```{stata det0b, eval= F} -->
<!-- local i=1  -->
<!-- global _i=1 -->
<!-- ``` -->
<!-- Damit könnte man auch so alle `locals` auflisten: -->
<!-- ```{stata alllocas, eval = F} -->
<!-- glo x1 = 2 -->
<!-- glo x2 "das ist x2" -->
<!-- glo x 291 -->
<!-- global allglo:  all globals "_x*" -->
<!-- mac l allglo -->
<!-- ``` -->
<!-- ```{stata det1, eval= F} -->
<!-- global a "myvar" -->
<!-- gen $a = oldvar   gen myvar = oldvar -->
<!-- gen a = oldvar    gen a = oldvar -->
<!-- local a "myvar" -->
<!-- gen ‘a’ = oldvar gen myvar = oldvar -->
<!-- gen a = oldvar gen a = oldvar -->
<!-- global a "newvar" -->
<!-- global i = 2 -->
<!-- gen $a$i = oldvar gen newvar2 = oldvar -->
<!-- local a "newvar" -->
<!-- local i = 2 -->
<!-- gen ‘a’‘i’ = oldvar gen newvar2 = oldvar -->
<!-- global b1 "newvar" -->
<!-- global i=1 -->
<!-- gen ${b$i} = oldvar gen newvar = oldvar -->
<!-- local b1 "newvar" -->
<!-- local i=1 -->
<!-- gen ‘b‘i’’ = oldvar gen newvar = oldvar -->
<!-- global b1 "newvar" -->
<!-- global a "b" -->
<!-- global i = 1 -->
<!-- gen ${$a$i} = oldvar gen newvar = oldvar -->
<!-- local b1 "newvar" -->
<!-- local a "b" -->
<!-- local i = 1 -->
<!-- gen ‘‘a’‘i’’ = oldvar gen newvar = oldvar -->
<!-- ``` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="loopmacro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Progammieren mit Stata BIBB.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
